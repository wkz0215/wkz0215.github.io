
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<title>Cookbook &#8212; pandas 1.5.1 documentation</title>
<script>
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>

<link href="theme.css-digest=9b1a4fa89bdd0e95b23b.css" tppabs="https://pandas.pydata.org/pandas-docs/stable/_static/styles/theme.css?digest=9b1a4fa89bdd0e95b23b" rel="stylesheet">
<link href="pydata-sphinx-theme.css-digest=9b1a4fa89bdd0e95b23b.css" tppabs="https://pandas.pydata.org/pandas-docs/stable/_static/styles/pydata-sphinx-theme.css?digest=9b1a4fa89bdd0e95b23b" rel="stylesheet">
<link rel="stylesheet" href="all.min.css" tppabs="https://pandas.pydata.org/pandas-docs/stable/_static/vendor/fontawesome/6.1.2/css/all.min.css">
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2">
<link rel="stylesheet" type="text/css" href="pygments.css" tppabs="https://pandas.pydata.org/pandas-docs/stable/_static/pygments.css" />
<link rel="stylesheet" type="text/css" href="plot_directive.css" tppabs="https://pandas.pydata.org/pandas-docs/stable/_static/plot_directive.css" />
<link rel="stylesheet" type="text/css" href="copybutton.css" tppabs="https://pandas.pydata.org/pandas-docs/stable/_static/copybutton.css" />
<link rel="stylesheet" type="text/css" href="panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" tppabs="https://pandas.pydata.org/pandas-docs/stable/_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
<link rel="stylesheet" type="text/css" href="panels-variables.06eb56fa6e07937060861dad626602ad.css" tppabs="https://pandas.pydata.org/pandas-docs/stable/_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
<link rel="stylesheet" type="text/css" href="getting_started.css" tppabs="https://pandas.pydata.org/pandas-docs/stable/_static/css/getting_started.css" />
<link rel="stylesheet" type="text/css" href="pandas.css" tppabs="https://pandas.pydata.org/pandas-docs/stable/_static/css/pandas.css" />

<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=9b1a4fa89bdd0e95b23b">
<script data-url_root="../" id="documentation_options" src="documentation_options.js" tppabs="https://pandas.pydata.org/pandas-docs/stable/_static/documentation_options.js"></script>
<script src="jquery.js" tppabs="https://pandas.pydata.org/pandas-docs/stable/_static/jquery.js"></script>
<script src="underscore.js" tppabs="https://pandas.pydata.org/pandas-docs/stable/_static/underscore.js"></script>
<script src="doctools.js" tppabs="https://pandas.pydata.org/pandas-docs/stable/_static/doctools.js"></script>
<script src="clipboard.min.js" tppabs="https://pandas.pydata.org/pandas-docs/stable/_static/clipboard.min.js"></script>
<script src="copybutton.js" tppabs="https://pandas.pydata.org/pandas-docs/stable/_static/copybutton.js"></script>
<script src="toggleprompt.js" tppabs="https://pandas.pydata.org/pandas-docs/stable/_static/toggleprompt.js"></script>
<script src="embed-amd.js" tppabs="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
<script async="async" src="analytics.js" tppabs="https://www.google-analytics.com/analytics.js"></script>
<script>
                    window.ga = window.ga || function () {
                        (ga.q = ga.q || []).push(arguments) };
                    ga.l = +new Date;
                    ga('create', 'UA-27880019-2', 'auto');
                    ga('set', 'anonymizeIp', true);
                    ga('send', 'pageview');
                </script>
<script>DOCUMENTATION_OPTIONS.pagename = 'user_guide/cookbook';</script>
<script>
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://pandas.pydata.org/versions.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '1.5.1';
        </script>
<link rel="shortcut icon" href="../_static/favicon.ico" />
<link rel="index" title="Index" href="../genindex.html" />
<link rel="search" title="Search" href="../search.html" />
<link rel="next" title="API reference" href="../reference/index.html" />
<link rel="prev" title="Frequently Asked Questions (FAQ)" href="gotchas.html" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="docsearch:language" content="en">
</head>
<body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">
<input type="checkbox" class="sidebar-toggle" name="__primary" id="__primary">
<label class="overlay overlay-primary" for="__primary"></label>
<input type="checkbox" class="sidebar-toggle" name="__secondary" id="__secondary">
<label class="overlay overlay-secondary" for="__secondary"></label>
<div class="search-button__wrapper">
<div class="search-button__overlay"></div>
<div class="search-button__search-container">
<form class="bd-search d-flex align-items-center" action="https://pandas.pydata.org/pandas-docs/stable/search.html" method="get">
<i class="icon fas fa-search"></i>
<input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
<span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
</div>
</div>
<nav class="bd-header navbar navbar-expand-lg bd-navbar" id="navbar-main"><div class="bd-header__inner bd-page-width">
<label class="sidebar-toggle primary-toggle" for="__primary">
<span class="fas fa-bars"></span>
</label>
<div id="navbar-start">
<a class="navbar-brand logo" href="index-5.html" tppabs="https://pandas.pydata.org/pandas-docs/stable/index.html">
<img src="pandas.svg" tppabs="https://pandas.pydata.org/pandas-docs/stable/_static/pandas.svg" class="logo__image only-light" alt="Logo image">
<img src="pandas_white.svg" tppabs="https://pandas.pydata.org/static/img/pandas_white.svg" class="logo__image only-dark" alt="Logo image">
</a>
</div>
<div class="col-lg-9 navbar-header-items">
<div id="navbar-center" class="mr-auto">
<div class="navbar-center-item">
<nav class="navbar-nav">
<p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
Site Navigation
</p>
<ul id="navbar-main-elements" class="navbar-nav">
<li class="nav-item">
<a class="nav-link" href="index.html" tppabs="https://pandas.pydata.org/pandas-docs/stable/getting_started/index.html">
Getting started
</a>
</li>
<li class="nav-item current active">
<a class="nav-link" href="index-1.html" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/index.html">
User Guide
</a>
</li>
<li class="nav-item">
<a class="nav-link" href="index-2.html" tppabs="https://pandas.pydata.org/pandas-docs/stable/reference/index.html">
API reference
</a>
</li>
<li class="nav-item">
<a class="nav-link" href="index-3.html" tppabs="https://pandas.pydata.org/pandas-docs/stable/development/index.html">
Development
</a>
</li>
<li class="nav-item">
<a class="nav-link" href="index-4.html" tppabs="https://pandas.pydata.org/pandas-docs/stable/whatsnew/index.html">
Release notes
</a>
</li>
</ul>
</nav>
</div>
</div>
<div id="navbar-end">
<div class="navbar-end-item navbar-end__search-button-container">
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search">
<i class="fas fa-search"></i>
</button>
</div>
<div class="navbar-end-item">
<div class="version-switcher__container dropdown">
<button type="button" class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle" data-toggle="dropdown">
1.5.1 
<span class="caret"></span>
</button>
<div class="version-switcher__menu dropdown-menu list-group-flush py-0">

</div>
</div>
</div>
<div class="navbar-end-item">
<span class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle">
<a class="theme-switch" data-mode="light"><i class="fas fa-sun"></i></a>
<a class="theme-switch" data-mode="dark"><i class="far fa-moon"></i></a>
<a class="theme-switch" data-mode="auto"><i class="fas fa-adjust"></i></a>
</span>
</div>
<div class="navbar-end-item">
<ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
<li class="nav-item">
<a href="javascript:if(confirm('https://github.com/pandas-dev/pandas  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/pandas-dev/pandas'" tppabs="https://github.com/pandas-dev/pandas" title="GitHub" class="nav-link" rel="noopener" target="_blank"><span><i class="fab fa-github-square"></i></span>
<label class="sr-only">GitHub</label></a>
</li>
<li class="nav-item">
<a href="javascript:if(confirm('https://twitter.com/pandas_dev  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://twitter.com/pandas_dev'" tppabs="https://twitter.com/pandas_dev" title="Twitter" class="nav-link" rel="noopener" target="_blank"><span><i class="fab fa-twitter-square"></i></span>
<label class="sr-only">Twitter</label></a>
</li>
</ul>
</div>
</div>
</div>
<div class="search-button-container--mobile">
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search">
<i class="fas fa-search"></i>
</button>
</div>
<label class="sidebar-toggle secondary-toggle" for="__secondary">
<span class="fas fa-outdent"></span>
</label>
</div>
</nav>
<div class="bd-container">
<div class="bd-container__inner bd-page-width">
<div class="bd-sidebar-primary bd-sidebar">
<div class="sidebar-header-items sidebar-primary__section">
<div class="sidebar-header-items__center">
<div class="navbar-center-item">
<nav class="navbar-nav">
<p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
Site Navigation
</p>
<ul id="navbar-main-elements" class="navbar-nav">
<li class="nav-item">
<a class="nav-link" href="index.html" tppabs="https://pandas.pydata.org/pandas-docs/stable/getting_started/index.html">
Getting started
</a>
</li>
<li class="nav-item current active">
<a class="nav-link" href="index-1.html" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/index.html">
User Guide
</a>
</li>
<li class="nav-item">
<a class="nav-link" href="index-2.html" tppabs="https://pandas.pydata.org/pandas-docs/stable/reference/index.html">
API reference
</a>
</li>
<li class="nav-item">
<a class="nav-link" href="index-3.html" tppabs="https://pandas.pydata.org/pandas-docs/stable/development/index.html">
Development
</a>
</li>
<li class="nav-item">
<a class="nav-link" href="index-4.html" tppabs="https://pandas.pydata.org/pandas-docs/stable/whatsnew/index.html">
Release notes
</a>
</li>
</ul>
</nav>
</div>
</div>
<div class="sidebar-header-items__end">
<div class="navbar-end-item">
<div class="version-switcher__container dropdown">
<button type="button" class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle" data-toggle="dropdown">
1.5.1 
<span class="caret"></span>
</button>
<div class="version-switcher__menu dropdown-menu list-group-flush py-0">

</div>
</div>
</div>
<div class="navbar-end-item">
<span class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle">
<a class="theme-switch" data-mode="light"><i class="fas fa-sun"></i></a>
<a class="theme-switch" data-mode="dark"><i class="far fa-moon"></i></a>
<a class="theme-switch" data-mode="auto"><i class="fas fa-adjust"></i></a>
</span>
</div>
<div class="navbar-end-item">
<ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
<li class="nav-item">
<a href="javascript:if(confirm('https://github.com/pandas-dev/pandas  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/pandas-dev/pandas'" tppabs="https://github.com/pandas-dev/pandas" title="GitHub" class="nav-link" rel="noopener" target="_blank"><span><i class="fab fa-github-square"></i></span>
<label class="sr-only">GitHub</label></a>
</li>
<li class="nav-item">
<a href="javascript:if(confirm('https://twitter.com/pandas_dev  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://twitter.com/pandas_dev'" tppabs="https://twitter.com/pandas_dev" title="Twitter" class="nav-link" rel="noopener" target="_blank"><span><i class="fab fa-twitter-square"></i></span>
<label class="sr-only">Twitter</label></a>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebar-start-items sidebar-primary__section">
<div class="sidebar-start-items__item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
<div class="bd-toc-item navbar-nav">
<ul class="current nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="10min.html" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/10min.html">
10 minutes to pandas
</a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="dsintro.html" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/dsintro.html">
Intro to data structures
</a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="basics.html" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/basics.html">
Essential basic functionality
</a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="io.html" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/io.html">
IO tools (text, CSV, HDF5, â€¦)
</a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="indexing.html" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html">
Indexing and selecting data
</a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="advanced.html" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/advanced.html">
MultiIndex / advanced indexing
</a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="merging.html" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/merging.html">
Merge, join, concatenate and compare
</a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="reshaping.html" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/reshaping.html">
Reshaping and pivot tables
</a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="text.html" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/text.html">
Working with text data
</a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="missing_data.html" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/missing_data.html">
Working with missing data
</a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="duplicates.html" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/duplicates.html">
Duplicate Labels
</a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="categorical.html" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/categorical.html">
Categorical data
</a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="integer_na.html" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/integer_na.html">
Nullable integer data type
</a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="boolean.html" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/boolean.html">
Nullable Boolean data type
</a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="visualization.html" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/visualization.html">
Chart visualization
</a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="style.html" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/style.html">
Table Visualization
</a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="groupby.html" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/groupby.html">
Group by: split-apply-combine
</a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="window.html" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/window.html">
Windowing operations
</a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="timeseries.html" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html">
Time series / date functionality
</a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="timedeltas.html" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/timedeltas.html">
Time deltas
</a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="options.html" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/options.html">
Options and settings
</a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="enhancingperf.html" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/enhancingperf.html">
Enhancing performance
</a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="scale.html" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/scale.html">
Scaling to large datasets
</a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="sparse.html" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/sparse.html">
Sparse data structures
</a>
</li>
<li class="toctree-l1">
<a class="reference internal" href="gotchas.html" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/gotchas.html">
Frequently Asked Questions (FAQ)
</a>
</li>
<li class="toctree-l1 current active">
<a class="current reference internal" href="#">
Cookbook
</a>
</li>
</ul>
</div>
</nav>
</div>
</div>
<div class="sidebar-end-items sidebar-primary__section">
<div class="sidebar-end-items__item">
</div>
</div>
</div>
<main class="bd-main">
<div class="bd-content">
<div class="bd-article-container">
<div class="bd-header-article">
</div>
<article class="bd-article" role="main">
<section id="cookbook">
<span id="id1"></span><h1>Cookbook<a class="headerlink" href="#cookbook" title="Permalink to this headline">#</a></h1>
<p>This is a repository for <em>short and sweet</em> examples and links for useful pandas recipes.
We encourage users to add to this documentation.</p>
<p>Adding interesting links and/or inline examples to this section is a great <em>First Pull Request</em>.</p>
<p>Simplified, condensed, new-user friendly, in-line examples have been inserted where possible to
augment the Stack-Overflow and GitHub links. Many of the links contain expanded information,
above what the in-line examples offer.</p>
<p>pandas (pd) and NumPy (np) are the only two abbreviated imported modules. The rest are kept
explicitly imported for newer users.</p>
<section id="idioms">
<h2>Idioms<a class="headerlink" href="#idioms" title="Permalink to this headline">#</a></h2>
<p id="cookbook-idioms">These are some neat pandas <code class="docutils literal notranslate"><span class="pre">idioms</span></code></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/17128302/python-pandas-idiom-for-if-then-else  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/17128302/python-pandas-idiom-for-if-then-else'" tppabs="https://stackoverflow.com/questions/17128302/python-pandas-idiom-for-if-then-else">if-then/if-then-else on one column, and assignment to another one or more columns:</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">   ...: </span>    <span class="p">{</span><span class="s2">&quot;AAA&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="s2">&quot;BBB&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="s2">&quot;CCC&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">]}</span>
<span class="gp">   ...: </span><span class="p">)</span>
<span class="gp">   ...: </span>

<span class="gp">In [2]: </span><span class="n">df</span>
<span class="gh">Out[2]: </span><span class="go"></span>
<span class="go">   AAA  BBB  CCC</span>
<span class="go">0    4   10  100</span>
<span class="go">1    5   20   50</span>
<span class="go">2    6   30  -30</span>
<span class="go">3    7   40  -50</span>
</pre></div>
</div>
<section id="if-then">
<h3>if-thenâ€¦<a class="headerlink" href="#if-then" title="Permalink to this headline">#</a></h3>
<p>An if-then on one column</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [3]: </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">AAA</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;BBB&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

<span class="gp">In [4]: </span><span class="n">df</span>
<span class="gh">Out[4]: </span><span class="go"></span>
<span class="go">   AAA  BBB  CCC</span>
<span class="go">0    4   10  100</span>
<span class="go">1    5   -1   50</span>
<span class="go">2    6   -1  -30</span>
<span class="go">3    7   -1  -50</span>
</pre></div>
</div>
<p>An if-then with assignment to 2 columns:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [5]: </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">AAA</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;BBB&quot;</span><span class="p">,</span> <span class="s2">&quot;CCC&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">555</span>

<span class="gp">In [6]: </span><span class="n">df</span>
<span class="gh">Out[6]: </span><span class="go"></span>
<span class="go">   AAA  BBB  CCC</span>
<span class="go">0    4   10  100</span>
<span class="go">1    5  555  555</span>
<span class="go">2    6  555  555</span>
<span class="go">3    7  555  555</span>
</pre></div>
</div>
<p>Add another line with different logic, to do the -else</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [7]: </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">AAA</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;BBB&quot;</span><span class="p">,</span> <span class="s2">&quot;CCC&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">2000</span>

<span class="gp">In [8]: </span><span class="n">df</span>
<span class="gh">Out[8]: </span><span class="go"></span>
<span class="go">   AAA   BBB   CCC</span>
<span class="go">0    4  2000  2000</span>
<span class="go">1    5   555   555</span>
<span class="go">2    6   555   555</span>
<span class="go">3    7   555   555</span>
</pre></div>
</div>
<p>Or use pandas where after youâ€™ve set up a mask</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [9]: </span><span class="n">df_mask</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">   ...: </span>    <span class="p">{</span><span class="s2">&quot;AAA&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;BBB&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;CCC&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">}</span>
<span class="gp">   ...: </span><span class="p">)</span>
<span class="gp">   ...: </span>

<span class="gp">In [10]: </span><span class="n">df</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df_mask</span><span class="p">,</span> <span class="o">-</span><span class="mi">1000</span><span class="p">)</span>
<span class="gh">Out[10]: </span><span class="go"></span>
<span class="go">   AAA   BBB   CCC</span>
<span class="go">0    4 -1000  2000</span>
<span class="go">1    5 -1000 -1000</span>
<span class="go">2    6 -1000   555</span>
<span class="go">3    7 -1000 -1000</span>
</pre></div>
</div>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/19913659/pandas-conditional-creation-of-a-series-dataframe-column  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/19913659/pandas-conditional-creation-of-a-series-dataframe-column'" tppabs="https://stackoverflow.com/questions/19913659/pandas-conditional-creation-of-a-series-dataframe-column">if-then-else using NumPyâ€™s where()</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [11]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">   ....: </span>    <span class="p">{</span><span class="s2">&quot;AAA&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="s2">&quot;BBB&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="s2">&quot;CCC&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">]}</span>
<span class="gp">   ....: </span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="gp">In [12]: </span><span class="n">df</span>
<span class="gh">Out[12]: </span><span class="go"></span>
<span class="go">   AAA  BBB  CCC</span>
<span class="go">0    4   10  100</span>
<span class="go">1    5   20   50</span>
<span class="go">2    6   30  -30</span>
<span class="go">3    7   40  -50</span>

<span class="gp">In [13]: </span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;logic&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;AAA&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;high&quot;</span><span class="p">,</span> <span class="s2">&quot;low&quot;</span><span class="p">)</span>

<span class="gp">In [14]: </span><span class="n">df</span>
<span class="gh">Out[14]: </span><span class="go"></span>
<span class="go">   AAA  BBB  CCC logic</span>
<span class="go">0    4   10  100   low</span>
<span class="go">1    5   20   50   low</span>
<span class="go">2    6   30  -30  high</span>
<span class="go">3    7   40  -50  high</span>
</pre></div>
</div>
</section>
<section id="splitting">
<h3>Splitting<a class="headerlink" href="#splitting" title="Permalink to this headline">#</a></h3>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/14957116/how-to-split-a-dataframe-according-to-a-boolean-criterion  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/14957116/how-to-split-a-dataframe-according-to-a-boolean-criterion'" tppabs="https://stackoverflow.com/questions/14957116/how-to-split-a-dataframe-according-to-a-boolean-criterion">Split a frame with a boolean criterion</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [15]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">   ....: </span>    <span class="p">{</span><span class="s2">&quot;AAA&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="s2">&quot;BBB&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="s2">&quot;CCC&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">]}</span>
<span class="gp">   ....: </span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="gp">In [16]: </span><span class="n">df</span>
<span class="gh">Out[16]: </span><span class="go"></span>
<span class="go">   AAA  BBB  CCC</span>
<span class="go">0    4   10  100</span>
<span class="go">1    5   20   50</span>
<span class="go">2    6   30  -30</span>
<span class="go">3    7   40  -50</span>

<span class="gp">In [17]: </span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">AAA</span> <span class="o">&lt;=</span> <span class="mi">5</span><span class="p">]</span>
<span class="gh">Out[17]: </span><span class="go"></span>
<span class="go">   AAA  BBB  CCC</span>
<span class="go">0    4   10  100</span>
<span class="go">1    5   20   50</span>

<span class="gp">In [18]: </span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">AAA</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">]</span>
<span class="gh">Out[18]: </span><span class="go"></span>
<span class="go">   AAA  BBB  CCC</span>
<span class="go">2    6   30  -30</span>
<span class="go">3    7   40  -50</span>
</pre></div>
</div>
</section>
<section id="building-criteria">
<h3>Building criteria<a class="headerlink" href="#building-criteria" title="Permalink to this headline">#</a></h3>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/15315452/selecting-with-complex-criteria-from-pandas-dataframe  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/15315452/selecting-with-complex-criteria-from-pandas-dataframe'" tppabs="https://stackoverflow.com/questions/15315452/selecting-with-complex-criteria-from-pandas-dataframe">Select with multi-column criteria</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [19]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">   ....: </span>    <span class="p">{</span><span class="s2">&quot;AAA&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="s2">&quot;BBB&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="s2">&quot;CCC&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">]}</span>
<span class="gp">   ....: </span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="gp">In [20]: </span><span class="n">df</span>
<span class="gh">Out[20]: </span><span class="go"></span>
<span class="go">   AAA  BBB  CCC</span>
<span class="go">0    4   10  100</span>
<span class="go">1    5   20   50</span>
<span class="go">2    6   30  -30</span>
<span class="go">3    7   40  -50</span>
</pre></div>
</div>
<p>â€¦and (without assignment returns a Series)</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [21]: </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;BBB&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">25</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;CCC&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">40</span><span class="p">),</span> <span class="s2">&quot;AAA&quot;</span><span class="p">]</span>
<span class="gh">Out[21]: </span><span class="go"></span>
<span class="go">0    4</span>
<span class="go">1    5</span>
<span class="go">Name: AAA, dtype: int64</span>
</pre></div>
</div>
<p>â€¦or (without assignment returns a Series)</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [22]: </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;BBB&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">25</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;CCC&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="mi">40</span><span class="p">),</span> <span class="s2">&quot;AAA&quot;</span><span class="p">]</span>
<span class="gh">Out[22]: </span><span class="go"></span>
<span class="go">0    4</span>
<span class="go">1    5</span>
<span class="go">2    6</span>
<span class="go">3    7</span>
<span class="go">Name: AAA, dtype: int64</span>
</pre></div>
</div>
<p>â€¦or (with assignment modifies the DataFrame.)</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [23]: </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;BBB&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">25</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;CCC&quot;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">75</span><span class="p">),</span> <span class="s2">&quot;AAA&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.1</span>

<span class="gp">In [24]: </span><span class="n">df</span>
<span class="gh">Out[24]: </span><span class="go"></span>
<span class="go">   AAA  BBB  CCC</span>
<span class="go">0  0.1   10  100</span>
<span class="go">1  5.0   20   50</span>
<span class="go">2  0.1   30  -30</span>
<span class="go">3  0.1   40  -50</span>
</pre></div>
</div>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/17758023/return-rows-in-a-dataframe-closest-to-a-user-defined-number  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/17758023/return-rows-in-a-dataframe-closest-to-a-user-defined-number'" tppabs="https://stackoverflow.com/questions/17758023/return-rows-in-a-dataframe-closest-to-a-user-defined-number">Select rows with data closest to certain value using argsort</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [25]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">   ....: </span>    <span class="p">{</span><span class="s2">&quot;AAA&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="s2">&quot;BBB&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="s2">&quot;CCC&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">]}</span>
<span class="gp">   ....: </span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="gp">In [26]: </span><span class="n">df</span>
<span class="gh">Out[26]: </span><span class="go"></span>
<span class="go">   AAA  BBB  CCC</span>
<span class="go">0    4   10  100</span>
<span class="go">1    5   20   50</span>
<span class="go">2    6   30  -30</span>
<span class="go">3    7   40  -50</span>

<span class="gp">In [27]: </span><span class="n">aValue</span> <span class="o">=</span> <span class="mf">43.0</span>

<span class="gp">In [28]: </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="o">.</span><span class="n">CCC</span> <span class="o">-</span> <span class="n">aValue</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">argsort</span><span class="p">()]</span>
<span class="gh">Out[28]: </span><span class="go"></span>
<span class="go">   AAA  BBB  CCC</span>
<span class="go">1    5   20   50</span>
<span class="go">0    4   10  100</span>
<span class="go">2    6   30  -30</span>
<span class="go">3    7   40  -50</span>
</pre></div>
</div>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/21058254/pandas-boolean-operation-in-a-python-list/21058331  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/21058254/pandas-boolean-operation-in-a-python-list/21058331'" tppabs="https://stackoverflow.com/questions/21058254/pandas-boolean-operation-in-a-python-list/21058331">Dynamically reduce a list of criteria using a binary operators</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [29]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">   ....: </span>    <span class="p">{</span><span class="s2">&quot;AAA&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="s2">&quot;BBB&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="s2">&quot;CCC&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">]}</span>
<span class="gp">   ....: </span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="gp">In [30]: </span><span class="n">df</span>
<span class="gh">Out[30]: </span><span class="go"></span>
<span class="go">   AAA  BBB  CCC</span>
<span class="go">0    4   10  100</span>
<span class="go">1    5   20   50</span>
<span class="go">2    6   30  -30</span>
<span class="go">3    7   40  -50</span>

<span class="gp">In [31]: </span><span class="n">Crit1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">AAA</span> <span class="o">&lt;=</span> <span class="mf">5.5</span>

<span class="gp">In [32]: </span><span class="n">Crit2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">BBB</span> <span class="o">==</span> <span class="mf">10.0</span>

<span class="gp">In [33]: </span><span class="n">Crit3</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">CCC</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mf">40.0</span>
</pre></div>
</div>
<p>One could hard code:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [34]: </span><span class="n">AllCrit</span> <span class="o">=</span> <span class="n">Crit1</span> <span class="o">&amp;</span> <span class="n">Crit2</span> <span class="o">&amp;</span> <span class="n">Crit3</span>
</pre></div>
</div>
<p>â€¦Or it can be done with a list of dynamically built criteria</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [35]: </span><span class="kn">import</span> <span class="nn">functools</span>

<span class="gp">In [36]: </span><span class="n">CritList</span> <span class="o">=</span> <span class="p">[</span><span class="n">Crit1</span><span class="p">,</span> <span class="n">Crit2</span><span class="p">,</span> <span class="n">Crit3</span><span class="p">]</span>

<span class="gp">In [37]: </span><span class="n">AllCrit</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span> <span class="o">&amp;</span> <span class="n">y</span><span class="p">,</span> <span class="n">CritList</span><span class="p">)</span>

<span class="gp">In [38]: </span><span class="n">df</span><span class="p">[</span><span class="n">AllCrit</span><span class="p">]</span>
<span class="gh">Out[38]: </span><span class="go"></span>
<span class="go">   AAA  BBB  CCC</span>
<span class="go">0    4   10  100</span>
</pre></div>
</div>
</section>
</section>
<section id="selection">
<span id="cookbook-selection"></span><h2>Selection<a class="headerlink" href="#selection" title="Permalink to this headline">#</a></h2>
<section id="dataframes">
<h3>Dataframes<a class="headerlink" href="#dataframes" title="Permalink to this headline">#</a></h3>
<p>The <a class="reference internal" href="indexing.html#indexing" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#indexing"><span class="std std-ref">indexing</span></a> docs.</p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/14725068/pandas-using-row-labels-in-boolean-indexing  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/14725068/pandas-using-row-labels-in-boolean-indexing'" tppabs="https://stackoverflow.com/questions/14725068/pandas-using-row-labels-in-boolean-indexing">Using both row labels and value conditionals</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [39]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">   ....: </span>    <span class="p">{</span><span class="s2">&quot;AAA&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="s2">&quot;BBB&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="s2">&quot;CCC&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">]}</span>
<span class="gp">   ....: </span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="gp">In [40]: </span><span class="n">df</span>
<span class="gh">Out[40]: </span><span class="go"></span>
<span class="go">   AAA  BBB  CCC</span>
<span class="go">0    4   10  100</span>
<span class="go">1    5   20   50</span>
<span class="go">2    6   30  -30</span>
<span class="go">3    7   40  -50</span>

<span class="gp">In [41]: </span><span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="o">.</span><span class="n">AAA</span> <span class="o">&lt;=</span> <span class="mi">6</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]))]</span>
<span class="gh">Out[41]: </span><span class="go"></span>
<span class="go">   AAA  BBB  CCC</span>
<span class="go">0    4   10  100</span>
<span class="go">2    6   30  -30</span>
</pre></div>
</div>
<p>Use loc for label-oriented slicing and iloc positional slicing <a class="reference external" href="javascript:if(confirm('https://github.com/pandas-dev/pandas/issues/2904  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/pandas-dev/pandas/issues/2904'" tppabs="https://github.com/pandas-dev/pandas/issues/2904">GH2904</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [42]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">   ....: </span>    <span class="p">{</span><span class="s2">&quot;AAA&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="s2">&quot;BBB&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="s2">&quot;CCC&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">]},</span>
<span class="gp">   ....: </span>    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="s2">&quot;boo&quot;</span><span class="p">,</span> <span class="s2">&quot;kar&quot;</span><span class="p">],</span>
<span class="gp">   ....: </span><span class="p">)</span>
<span class="gp">   ....: </span>
</pre></div>
</div>
<p>There are 2 explicit slicing methods, with a third general case</p>
<ol class="arabic simple">
<li><p>Positional-oriented (Python slicing style : exclusive of end)</p></li>
<li><p>Label-oriented (Non-Python slicing style : inclusive of end)</p></li>
<li><p>General (Either slicing style : depends on if the slice contains labels or positions)</p></li>
</ol>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [43]: </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;bar&quot;</span><span class="p">:</span><span class="s2">&quot;kar&quot;</span><span class="p">]</span>  <span class="c1"># Label</span>
<span class="gh">Out[43]: </span><span class="go"></span>
<span class="go">     AAA  BBB  CCC</span>
<span class="go">bar    5   20   50</span>
<span class="go">boo    6   30  -30</span>
<span class="go">kar    7   40  -50</span>

<span class="go"># Generic</span>
<span class="gp">In [44]: </span><span class="n">df</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="gh">Out[44]: </span><span class="go"></span>
<span class="go">     AAA  BBB  CCC</span>
<span class="go">foo    4   10  100</span>
<span class="go">bar    5   20   50</span>
<span class="go">boo    6   30  -30</span>

<span class="gp">In [45]: </span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;bar&quot;</span><span class="p">:</span><span class="s2">&quot;kar&quot;</span><span class="p">]</span>
<span class="gh">Out[45]: </span><span class="go"></span>
<span class="go">     AAA  BBB  CCC</span>
<span class="go">bar    5   20   50</span>
<span class="go">boo    6   30  -30</span>
<span class="go">kar    7   40  -50</span>
</pre></div>
</div>
<p>Ambiguity arises when an index consists of integers with a non-zero start or non-unit increment.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [46]: </span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;AAA&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="s2">&quot;BBB&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="s2">&quot;CCC&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">]}</span>

<span class="gp">In [47]: </span><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>  <span class="c1"># Note index starts at 1.</span>

<span class="gp">In [48]: </span><span class="n">df2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>  <span class="c1"># Position-oriented</span>
<span class="gh">Out[48]: </span><span class="go"></span>
<span class="go">   AAA  BBB  CCC</span>
<span class="go">2    5   20   50</span>
<span class="go">3    6   30  -30</span>

<span class="gp">In [49]: </span><span class="n">df2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>  <span class="c1"># Label-oriented</span>
<span class="gh">Out[49]: </span><span class="go"></span>
<span class="go">   AAA  BBB  CCC</span>
<span class="go">1    4   10  100</span>
<span class="go">2    5   20   50</span>
<span class="go">3    6   30  -30</span>
</pre></div>
</div>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/q/14986510  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/q/14986510'" tppabs="https://stackoverflow.com/q/14986510">Using inverse operator (~) to take the complement of a mask</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [50]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">   ....: </span>    <span class="p">{</span><span class="s2">&quot;AAA&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="s2">&quot;BBB&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="s2">&quot;CCC&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="p">]}</span>
<span class="gp">   ....: </span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="gp">In [51]: </span><span class="n">df</span>
<span class="gh">Out[51]: </span><span class="go"></span>
<span class="go">   AAA  BBB  CCC</span>
<span class="go">0    4   10  100</span>
<span class="go">1    5   20   50</span>
<span class="go">2    6   30  -30</span>
<span class="go">3    7   40  -50</span>

<span class="gp">In [52]: </span><span class="n">df</span><span class="p">[</span><span class="o">~</span><span class="p">((</span><span class="n">df</span><span class="o">.</span><span class="n">AAA</span> <span class="o">&lt;=</span> <span class="mi">6</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])))]</span>
<span class="gh">Out[52]: </span><span class="go"></span>
<span class="go">   AAA  BBB  CCC</span>
<span class="go">1    5   20   50</span>
<span class="go">3    7   40  -50</span>
</pre></div>
</div>
</section>
<section id="new-columns">
<h3>New columns<a class="headerlink" href="#new-columns" title="Permalink to this headline">#</a></h3>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/16575868/efficiently-creating-additional-columns-in-a-pandas-dataframe-using-map  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/16575868/efficiently-creating-additional-columns-in-a-pandas-dataframe-using-map'" tppabs="https://stackoverflow.com/questions/16575868/efficiently-creating-additional-columns-in-a-pandas-dataframe-using-map">Efficiently and dynamically creating new columns using applymap</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [53]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;AAA&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;BBB&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;CCC&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]})</span>

<span class="gp">In [54]: </span><span class="n">df</span>
<span class="gh">Out[54]: </span><span class="go"></span>
<span class="go">   AAA  BBB  CCC</span>
<span class="go">0    1    1    2</span>
<span class="go">1    2    1    1</span>
<span class="go">2    1    2    3</span>
<span class="go">3    3    2    1</span>

<span class="gp">In [55]: </span><span class="n">source_cols</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span>  <span class="c1"># Or some subset would work too</span>

<span class="gp">In [56]: </span><span class="n">new_cols</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;_cat&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">source_cols</span><span class="p">]</span>

<span class="gp">In [57]: </span><span class="n">categories</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;Alpha&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s2">&quot;Beta&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s2">&quot;Charlie&quot;</span><span class="p">}</span>

<span class="gp">In [58]: </span><span class="n">df</span><span class="p">[</span><span class="n">new_cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">source_cols</span><span class="p">]</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="n">categories</span><span class="o">.</span><span class="n">get</span><span class="p">)</span>

<span class="gp">In [59]: </span><span class="n">df</span>
<span class="gh">Out[59]: </span><span class="go"></span>
<span class="go">   AAA  BBB  CCC  AAA_cat BBB_cat  CCC_cat</span>
<span class="go">0    1    1    2    Alpha   Alpha     Beta</span>
<span class="go">1    2    1    1     Beta   Alpha    Alpha</span>
<span class="go">2    1    2    3    Alpha    Beta  Charlie</span>
<span class="go">3    3    2    1  Charlie    Beta    Alpha</span>
</pre></div>
</div>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/q/23394476  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/q/23394476'" tppabs="https://stackoverflow.com/q/23394476">Keep other columns when using min() with groupby</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [60]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">   ....: </span>    <span class="p">{</span><span class="s2">&quot;AAA&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;BBB&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]}</span>
<span class="gp">   ....: </span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="gp">In [61]: </span><span class="n">df</span>
<span class="gh">Out[61]: </span><span class="go"></span>
<span class="go">   AAA  BBB</span>
<span class="go">0    1    2</span>
<span class="go">1    1    1</span>
<span class="go">2    1    3</span>
<span class="go">3    2    4</span>
<span class="go">4    2    5</span>
<span class="go">5    2    1</span>
<span class="go">6    3    2</span>
<span class="go">7    3    3</span>
</pre></div>
</div>
<p>Method 1 : idxmin() to get the index of the minimums</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [62]: </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;AAA&quot;</span><span class="p">)[</span><span class="s2">&quot;BBB&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span>
<span class="gh">Out[62]: </span><span class="go"></span>
<span class="go">   AAA  BBB</span>
<span class="go">1    1    1</span>
<span class="go">5    2    1</span>
<span class="go">6    3    2</span>
</pre></div>
</div>
<p>Method 2 : sort then take first of each</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [63]: </span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;BBB&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;AAA&quot;</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
<span class="gh">Out[63]: </span><span class="go"></span>
<span class="go">   AAA  BBB</span>
<span class="go">0    1    1</span>
<span class="go">1    2    1</span>
<span class="go">2    3    2</span>
</pre></div>
</div>
<p>Notice the same results, with the exception of the index.</p>
</section>
</section>
<section id="multiindexing">
<span id="cookbook-multi-index"></span><h2>Multiindexing<a class="headerlink" href="#multiindexing" title="Permalink to this headline">#</a></h2>
<p>The <a class="reference internal" href="advanced.html#advanced-hierarchical" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/advanced.html#advanced-hierarchical"><span class="std std-ref">multindexing</span></a> docs.</p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/14916358/reshaping-dataframes-in-pandas-based-on-column-labels  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/14916358/reshaping-dataframes-in-pandas-based-on-column-labels'" tppabs="https://stackoverflow.com/questions/14916358/reshaping-dataframes-in-pandas-based-on-column-labels">Creating a MultiIndex from a labeled frame</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [64]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">   ....: </span>    <span class="p">{</span>
<span class="gp">   ....: </span>        <span class="s2">&quot;row&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="gp">   ....: </span>        <span class="s2">&quot;One_X&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">],</span>
<span class="gp">   ....: </span>        <span class="s2">&quot;One_Y&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">],</span>
<span class="gp">   ....: </span>        <span class="s2">&quot;Two_X&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.11</span><span class="p">,</span> <span class="mf">1.11</span><span class="p">,</span> <span class="mf">1.11</span><span class="p">],</span>
<span class="gp">   ....: </span>        <span class="s2">&quot;Two_Y&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.22</span><span class="p">,</span> <span class="mf">1.22</span><span class="p">,</span> <span class="mf">1.22</span><span class="p">],</span>
<span class="gp">   ....: </span>    <span class="p">}</span>
<span class="gp">   ....: </span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="gp">In [65]: </span><span class="n">df</span>
<span class="gh">Out[65]: </span><span class="go"></span>
<span class="go">   row  One_X  One_Y  Two_X  Two_Y</span>
<span class="go">0    0    1.1    1.2   1.11   1.22</span>
<span class="go">1    1    1.1    1.2   1.11   1.22</span>
<span class="go">2    2    1.1    1.2   1.11   1.22</span>

<span class="go"># As Labelled Index</span>
<span class="gp">In [66]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;row&quot;</span><span class="p">)</span>

<span class="gp">In [67]: </span><span class="n">df</span>
<span class="gh">Out[67]: </span><span class="go"></span>
<span class="go">     One_X  One_Y  Two_X  Two_Y</span>
<span class="go">row                            </span>
<span class="go">0      1.1    1.2   1.11   1.22</span>
<span class="go">1      1.1    1.2   1.11   1.22</span>
<span class="go">2      1.1    1.2   1.11   1.22</span>

<span class="go"># With Hierarchical Columns</span>
<span class="gp">In [68]: </span><span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">([</span><span class="nb">tuple</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">))</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>

<span class="gp">In [69]: </span><span class="n">df</span>
<span class="gh">Out[69]: </span><span class="go"></span>
<span class="go">     One        Two      </span>
<span class="go">       X    Y     X     Y</span>
<span class="go">row                      </span>
<span class="go">0    1.1  1.2  1.11  1.22</span>
<span class="go">1    1.1  1.2  1.11  1.22</span>
<span class="go">2    1.1  1.2  1.11  1.22</span>

<span class="go"># Now stack &amp; Reset</span>
<span class="gp">In [70]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">In [71]: </span><span class="n">df</span>
<span class="gh">Out[71]: </span><span class="go"></span>
<span class="go">    level_1     X     Y</span>
<span class="go">row                    </span>
<span class="go">0       One  1.10  1.20</span>
<span class="go">0       Two  1.11  1.22</span>
<span class="go">1       One  1.10  1.20</span>
<span class="go">1       Two  1.11  1.22</span>
<span class="go">2       One  1.10  1.20</span>
<span class="go">2       Two  1.11  1.22</span>

<span class="go"># And fix the labels (Notice the label &#39;level_1&#39; got added automatically)</span>
<span class="gp">In [72]: </span><span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Sample&quot;</span><span class="p">,</span> <span class="s2">&quot;All_X&quot;</span><span class="p">,</span> <span class="s2">&quot;All_Y&quot;</span><span class="p">]</span>

<span class="gp">In [73]: </span><span class="n">df</span>
<span class="gh">Out[73]: </span><span class="go"></span>
<span class="go">    Sample  All_X  All_Y</span>
<span class="go">row                     </span>
<span class="go">0      One   1.10   1.20</span>
<span class="go">0      Two   1.11   1.22</span>
<span class="go">1      One   1.10   1.20</span>
<span class="go">1      Two   1.11   1.22</span>
<span class="go">2      One   1.10   1.20</span>
<span class="go">2      Two   1.11   1.22</span>
</pre></div>
</div>
<section id="arithmetic">
<h3>Arithmetic<a class="headerlink" href="#arithmetic" title="Permalink to this headline">#</a></h3>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/19501510/divide-entire-pandas-multiindex-dataframe-by-dataframe-variable/19502176  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/19501510/divide-entire-pandas-multiindex-dataframe-by-dataframe-variable/19502176#19502176'" tppabs="https://stackoverflow.com/questions/19501510/divide-entire-pandas-multiindex-dataframe-by-dataframe-variable/19502176#19502176">Performing arithmetic with a MultiIndex that needs broadcasting</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [74]: </span><span class="n">cols</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span>
<span class="gp">   ....: </span>    <span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;O&quot;</span><span class="p">,</span> <span class="s2">&quot;I&quot;</span><span class="p">]]</span>
<span class="gp">   ....: </span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="gp">In [75]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="n">cols</span><span class="p">)</span>

<span class="gp">In [76]: </span><span class="n">df</span>
<span class="gh">Out[76]: </span><span class="go"></span>
<span class="go">          A                   B                   C          </span>
<span class="go">          O         I         O         I         O         I</span>
<span class="go">n  0.469112 -0.282863 -1.509059 -1.135632  1.212112 -0.173215</span>
<span class="go">m  0.119209 -1.044236 -0.861849 -2.104569 -0.494929  1.071804</span>

<span class="gp">In [77]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">],</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">In [78]: </span><span class="n">df</span>
<span class="gh">Out[78]: </span><span class="go"></span>
<span class="go">          A                   B              C     </span>
<span class="go">          O         I         O         I    O    I</span>
<span class="go">n  0.387021  1.633022 -1.244983  6.556214  1.0  1.0</span>
<span class="go">m -0.240860 -0.974279  1.741358 -1.963577  1.0  1.0</span>
</pre></div>
</div>
</section>
<section id="slicing">
<h3>Slicing<a class="headerlink" href="#slicing" title="Permalink to this headline">#</a></h3>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/12590131/how-to-slice-multindex-columns-in-pandas-dataframes  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/12590131/how-to-slice-multindex-columns-in-pandas-dataframes'" tppabs="https://stackoverflow.com/questions/12590131/how-to-slice-multindex-columns-in-pandas-dataframes">Slicing a MultiIndex with xs</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [79]: </span><span class="n">coords</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;AA&quot;</span><span class="p">,</span> <span class="s2">&quot;one&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;AA&quot;</span><span class="p">,</span> <span class="s2">&quot;six&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;BB&quot;</span><span class="p">,</span> <span class="s2">&quot;one&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;BB&quot;</span><span class="p">,</span> <span class="s2">&quot;two&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;BB&quot;</span><span class="p">,</span> <span class="s2">&quot;six&quot;</span><span class="p">)]</span>

<span class="gp">In [80]: </span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>

<span class="gp">In [81]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="mi">11</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">55</span><span class="p">],</span> <span class="n">index</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;MyData&quot;</span><span class="p">])</span>

<span class="gp">In [82]: </span><span class="n">df</span>
<span class="gh">Out[82]: </span><span class="go"></span>
<span class="go">        MyData</span>
<span class="go">AA one      11</span>
<span class="go">   six      22</span>
<span class="go">BB one      33</span>
<span class="go">   two      44</span>
<span class="go">   six      55</span>
</pre></div>
</div>
<p>To take the cross section of the 1st level and 1st axis the index:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># Note : level and axis are optional, and default to zero</span>
<span class="gp">In [83]: </span><span class="n">df</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="s2">&quot;BB&quot;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gh">Out[83]: </span><span class="go"></span>
<span class="go">     MyData</span>
<span class="go">one      33</span>
<span class="go">two      44</span>
<span class="go">six      55</span>
</pre></div>
</div>
<p>â€¦and now the 2nd level of the 1st axis.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [84]: </span><span class="n">df</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="s2">&quot;six&quot;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gh">Out[84]: </span><span class="go"></span>
<span class="go">    MyData</span>
<span class="go">AA      22</span>
<span class="go">BB      55</span>
</pre></div>
</div>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/14964493/multiindex-based-indexing-in-pandas  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/14964493/multiindex-based-indexing-in-pandas'" tppabs="https://stackoverflow.com/questions/14964493/multiindex-based-indexing-in-pandas">Slicing a MultiIndex with xs, method #2</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [85]: </span><span class="kn">import</span> <span class="nn">itertools</span>

<span class="gp">In [86]: </span><span class="n">index</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">([</span><span class="s2">&quot;Ada&quot;</span><span class="p">,</span> <span class="s2">&quot;Quinn&quot;</span><span class="p">,</span> <span class="s2">&quot;Violet&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;Comp&quot;</span><span class="p">,</span> <span class="s2">&quot;Math&quot;</span><span class="p">,</span> <span class="s2">&quot;Sci&quot;</span><span class="p">]))</span>

<span class="gp">In [87]: </span><span class="n">headr</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">([</span><span class="s2">&quot;Exams&quot;</span><span class="p">,</span> <span class="s2">&quot;Labs&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;I&quot;</span><span class="p">,</span> <span class="s2">&quot;II&quot;</span><span class="p">]))</span>

<span class="gp">In [88]: </span><span class="n">indx</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Student&quot;</span><span class="p">,</span> <span class="s2">&quot;Course&quot;</span><span class="p">])</span>

<span class="gp">In [89]: </span><span class="n">cols</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">headr</span><span class="p">)</span>  <span class="c1"># Notice these are un-named</span>

<span class="gp">In [90]: </span><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">70</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span> <span class="o">%</span> <span class="mi">3</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)]</span>

<span class="gp">In [91]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">indx</span><span class="p">,</span> <span class="n">cols</span><span class="p">)</span>

<span class="gp">In [92]: </span><span class="n">df</span>
<span class="gh">Out[92]: </span><span class="go"></span>
<span class="go">               Exams     Labs    </span>
<span class="go">                   I  II    I  II</span>
<span class="go">Student Course                   </span>
<span class="go">Ada     Comp      70  71   72  73</span>
<span class="go">        Math      71  73   75  74</span>
<span class="go">        Sci       72  75   75  75</span>
<span class="go">Quinn   Comp      73  74   75  76</span>
<span class="go">        Math      74  76   78  77</span>
<span class="go">        Sci       75  78   78  78</span>
<span class="go">Violet  Comp      76  77   78  79</span>
<span class="go">        Math      77  79   81  80</span>
<span class="go">        Sci       78  81   81  81</span>

<span class="gp">In [93]: </span><span class="n">All</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

<span class="gp">In [94]: </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;Violet&quot;</span><span class="p">]</span>
<span class="gh">Out[94]: </span><span class="go"></span>
<span class="go">       Exams     Labs    </span>
<span class="go">           I  II    I  II</span>
<span class="go">Course                   </span>
<span class="go">Comp      76  77   78  79</span>
<span class="go">Math      77  79   81  80</span>
<span class="go">Sci       78  81   81  81</span>

<span class="gp">In [95]: </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">All</span><span class="p">,</span> <span class="s2">&quot;Math&quot;</span><span class="p">),</span> <span class="n">All</span><span class="p">]</span>
<span class="gh">Out[95]: </span><span class="go"></span>
<span class="go">               Exams     Labs    </span>
<span class="go">                   I  II    I  II</span>
<span class="go">Student Course                   </span>
<span class="go">Ada     Math      71  73   75  74</span>
<span class="go">Quinn   Math      74  76   78  77</span>
<span class="go">Violet  Math      77  79   81  80</span>

<span class="gp">In [96]: </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="nb">slice</span><span class="p">(</span><span class="s2">&quot;Ada&quot;</span><span class="p">,</span> <span class="s2">&quot;Quinn&quot;</span><span class="p">),</span> <span class="s2">&quot;Math&quot;</span><span class="p">),</span> <span class="n">All</span><span class="p">]</span>
<span class="gh">Out[96]: </span><span class="go"></span>
<span class="go">               Exams     Labs    </span>
<span class="go">                   I  II    I  II</span>
<span class="go">Student Course                   </span>
<span class="go">Ada     Math      71  73   75  74</span>
<span class="go">Quinn   Math      74  76   78  77</span>

<span class="gp">In [97]: </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">All</span><span class="p">,</span> <span class="s2">&quot;Math&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;Exams&quot;</span><span class="p">)]</span>
<span class="gh">Out[97]: </span><span class="go"></span>
<span class="go">                 I  II</span>
<span class="go">Student Course        </span>
<span class="go">Ada     Math    71  73</span>
<span class="go">Quinn   Math    74  76</span>
<span class="go">Violet  Math    77  79</span>

<span class="gp">In [98]: </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">All</span><span class="p">,</span> <span class="s2">&quot;Math&quot;</span><span class="p">),</span> <span class="p">(</span><span class="n">All</span><span class="p">,</span> <span class="s2">&quot;II&quot;</span><span class="p">)]</span>
<span class="gh">Out[98]: </span><span class="go"></span>
<span class="go">               Exams Labs</span>
<span class="go">                  II   II</span>
<span class="go">Student Course           </span>
<span class="go">Ada     Math      73   74</span>
<span class="go">Quinn   Math      76   77</span>
<span class="go">Violet  Math      79   80</span>
</pre></div>
</div>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/19319432/pandas-selecting-a-lower-level-in-a-dataframe-to-do-a-ffill  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/19319432/pandas-selecting-a-lower-level-in-a-dataframe-to-do-a-ffill'" tppabs="https://stackoverflow.com/questions/19319432/pandas-selecting-a-lower-level-in-a-dataframe-to-do-a-ffill">Setting portions of a MultiIndex with xs</a></p>
</section>
<section id="sorting">
<h3>Sorting<a class="headerlink" href="#sorting" title="Permalink to this headline">#</a></h3>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/q/14733871  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/q/14733871'" tppabs="https://stackoverflow.com/q/14733871">Sort by specific column or an ordered list of columns, with a MultiIndex</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [99]: </span><span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;Labs&quot;</span><span class="p">,</span> <span class="s2">&quot;II&quot;</span><span class="p">),</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gh">Out[99]: </span><span class="go"></span>
<span class="go">               Exams     Labs    </span>
<span class="go">                   I  II    I  II</span>
<span class="go">Student Course                   </span>
<span class="go">Violet  Sci       78  81   81  81</span>
<span class="go">        Math      77  79   81  80</span>
<span class="go">        Comp      76  77   78  79</span>
<span class="go">Quinn   Sci       75  78   78  78</span>
<span class="go">        Math      74  76   78  77</span>
<span class="go">        Comp      73  74   75  76</span>
<span class="go">Ada     Sci       72  75   75  75</span>
<span class="go">        Math      71  73   75  74</span>
<span class="go">        Comp      70  71   72  73</span>
</pre></div>
</div>
<p>Partial selection, the need for sortedness <a class="reference external" href="javascript:if(confirm('https://github.com/pandas-dev/pandas/issues/2995  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/pandas-dev/pandas/issues/2995'" tppabs="https://github.com/pandas-dev/pandas/issues/2995">GH2995</a></p>
</section>
<section id="levels">
<h3>Levels<a class="headerlink" href="#levels" title="Permalink to this headline">#</a></h3>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/14744068/prepend-a-level-to-a-pandas-multiindex  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/14744068/prepend-a-level-to-a-pandas-multiindex'" tppabs="https://stackoverflow.com/questions/14744068/prepend-a-level-to-a-pandas-multiindex">Prepending a level to a multiindex</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/q/14507794  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/q/14507794'" tppabs="https://stackoverflow.com/q/14507794">Flatten Hierarchical columns</a></p>
</section>
</section>
<section id="missing-data">
<span id="cookbook-missing-data"></span><h2>Missing data<a class="headerlink" href="#missing-data" title="Permalink to this headline">#</a></h2>
<p>The <a class="reference internal" href="missing_data.html#missing-data" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/missing_data.html#missing-data"><span class="std std-ref">missing data</span></a> docs.</p>
<p>Fill forward a reversed timeseries</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [100]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">   .....: </span>    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
<span class="gp">   .....: </span>    <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2013-08-01&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;B&quot;</span><span class="p">),</span>
<span class="gp">   .....: </span>    <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">),</span>
<span class="gp">   .....: </span><span class="p">)</span>
<span class="gp">   .....: </span>

<span class="gp">In [101]: </span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;A&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="gp">In [102]: </span><span class="n">df</span>
<span class="gh">Out[102]: </span><span class="go"></span>
<span class="go">                   A</span>
<span class="go">2013-08-01  0.721555</span>
<span class="go">2013-08-02 -0.706771</span>
<span class="go">2013-08-05 -1.039575</span>
<span class="go">2013-08-06       NaN</span>
<span class="go">2013-08-07 -0.424972</span>
<span class="go">2013-08-08  0.567020</span>

<span class="gp">In [103]: </span><span class="n">df</span><span class="o">.</span><span class="n">bfill</span><span class="p">()</span>
<span class="gh">Out[103]: </span><span class="go"></span>
<span class="go">                   A</span>
<span class="go">2013-08-01  0.721555</span>
<span class="go">2013-08-02 -0.706771</span>
<span class="go">2013-08-05 -1.039575</span>
<span class="go">2013-08-06 -0.424972</span>
<span class="go">2013-08-07 -0.424972</span>
<span class="go">2013-08-08  0.567020</span>
</pre></div>
</div>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/18196811/cumsum-reset-at-nan  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/18196811/cumsum-reset-at-nan'" tppabs="https://stackoverflow.com/questions/18196811/cumsum-reset-at-nan">cumsum reset at NaN values</a></p>
<section id="replace">
<h3>Replace<a class="headerlink" href="#replace" title="Permalink to this headline">#</a></h3>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/16818871/extracting-value-and-creating-new-column-out-of-it  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/16818871/extracting-value-and-creating-new-column-out-of-it'" tppabs="https://stackoverflow.com/questions/16818871/extracting-value-and-creating-new-column-out-of-it">Using replace with backrefs</a></p>
</section>
</section>
<section id="grouping">
<span id="cookbook-grouping"></span><h2>Grouping<a class="headerlink" href="#grouping" title="Permalink to this headline">#</a></h2>
<p>The <a class="reference internal" href="groupby.html#groupby" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/groupby.html#groupby"><span class="std std-ref">grouping</span></a> docs.</p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/15322632/python-pandas-df-groupy-agg-column-reference-in-agg  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/15322632/python-pandas-df-groupy-agg-column-reference-in-agg'" tppabs="https://stackoverflow.com/questions/15322632/python-pandas-df-groupy-agg-column-reference-in-agg">Basic grouping with apply</a></p>
<p>Unlike agg, applyâ€™s callable is passed a sub-DataFrame which gives you access to all the columns</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [104]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">   .....: </span>    <span class="p">{</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;animal&quot;</span><span class="p">:</span> <span class="s2">&quot;cat dog cat fish dog cat cat&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="s2">&quot;SSMMMLL&quot;</span><span class="p">),</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;adult&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">+</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span>
<span class="gp">   .....: </span>    <span class="p">}</span>
<span class="gp">   .....: </span><span class="p">)</span>
<span class="gp">   .....: </span>

<span class="gp">In [105]: </span><span class="n">df</span>
<span class="gh">Out[105]: </span><span class="go"></span>
<span class="go">  animal size  weight  adult</span>
<span class="go">0    cat    S       8  False</span>
<span class="go">1    dog    S      10  False</span>
<span class="go">2    cat    M      11  False</span>
<span class="go">3   fish    M       1  False</span>
<span class="go">4    dog    M      20  False</span>
<span class="go">5    cat    L      12   True</span>
<span class="go">6    cat    L      12   True</span>

<span class="go"># List the size of the animals with the highest weight.</span>
<span class="gp">In [106]: </span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;animal&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">subf</span><span class="p">:</span> <span class="n">subf</span><span class="p">[</span><span class="s2">&quot;size&quot;</span><span class="p">][</span><span class="n">subf</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()])</span>
<span class="gh">Out[106]: </span><span class="go"></span>
<span class="go">animal</span>
<span class="go">cat     L</span>
<span class="go">dog     M</span>
<span class="go">fish    M</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/14734533/how-to-access-pandas-groupby-dataframe-by-key  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/14734533/how-to-access-pandas-groupby-dataframe-by-key'" tppabs="https://stackoverflow.com/questions/14734533/how-to-access-pandas-groupby-dataframe-by-key">Using get_group</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [107]: </span><span class="n">gb</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;animal&quot;</span><span class="p">])</span>

<span class="gp">In [108]: </span><span class="n">gb</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="s2">&quot;cat&quot;</span><span class="p">)</span>
<span class="gh">Out[108]: </span><span class="go"></span>
<span class="go">  animal size  weight  adult</span>
<span class="go">0    cat    S       8  False</span>
<span class="go">2    cat    M      11  False</span>
<span class="go">5    cat    L      12   True</span>
<span class="go">6    cat    L      12   True</span>
</pre></div>
</div>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/15262134/apply-different-functions-to-different-items-in-group-object-python-pandas  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/15262134/apply-different-functions-to-different-items-in-group-object-python-pandas'" tppabs="https://stackoverflow.com/questions/15262134/apply-different-functions-to-different-items-in-group-object-python-pandas">Apply to different items in a group</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [109]: </span><span class="k">def</span> <span class="nf">GrowUp</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">   .....: </span>    <span class="n">avg_weight</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;size&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;S&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">weight</span> <span class="o">*</span> <span class="mf">1.5</span><span class="p">)</span>
<span class="gp">   .....: </span>    <span class="n">avg_weight</span> <span class="o">+=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;size&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;M&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">weight</span> <span class="o">*</span> <span class="mf">1.25</span><span class="p">)</span>
<span class="gp">   .....: </span>    <span class="n">avg_weight</span> <span class="o">+=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;size&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;L&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">weight</span><span class="p">)</span>
<span class="gp">   .....: </span>    <span class="n">avg_weight</span> <span class="o">/=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">   .....: </span>    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&quot;L&quot;</span><span class="p">,</span> <span class="n">avg_weight</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;size&quot;</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">,</span> <span class="s2">&quot;adult&quot;</span><span class="p">])</span>
<span class="gp">   .....: </span>

<span class="gp">In [110]: </span><span class="n">expected_df</span> <span class="o">=</span> <span class="n">gb</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">GrowUp</span><span class="p">)</span>

<span class="gp">In [111]: </span><span class="n">expected_df</span>
<span class="gh">Out[111]: </span><span class="go"></span>
<span class="go">       size   weight  adult</span>
<span class="go">animal                     </span>
<span class="go">cat       L  12.4375   True</span>
<span class="go">dog       L  20.0000   True</span>
<span class="go">fish      L   1.2500   True</span>
</pre></div>
</div>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/14542145/reductions-down-a-column-in-pandas  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/14542145/reductions-down-a-column-in-pandas'" tppabs="https://stackoverflow.com/questions/14542145/reductions-down-a-column-in-pandas">Expanding apply</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [112]: </span><span class="n">S</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">i</span> <span class="o">/</span> <span class="mf">100.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)])</span>

<span class="gp">In [113]: </span><span class="k">def</span> <span class="nf">cum_ret</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="gp">   .....: </span>    <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">   .....: </span>

<span class="gp">In [114]: </span><span class="k">def</span> <span class="nf">red</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">   .....: </span>    <span class="k">return</span> <span class="n">functools</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">cum_ret</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="gp">   .....: </span>

<span class="gp">In [115]: </span><span class="n">S</span><span class="o">.</span><span class="n">expanding</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">red</span><span class="p">,</span> <span class="n">raw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gh">Out[115]: </span><span class="go"></span>
<span class="go">0    1.010000</span>
<span class="go">1    1.030200</span>
<span class="go">2    1.061106</span>
<span class="go">3    1.103550</span>
<span class="go">4    1.158728</span>
<span class="go">5    1.228251</span>
<span class="go">6    1.314229</span>
<span class="go">7    1.419367</span>
<span class="go">8    1.547110</span>
<span class="go">9    1.701821</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/14760757/replacing-values-with-groupby-means  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/14760757/replacing-values-with-groupby-means'" tppabs="https://stackoverflow.com/questions/14760757/replacing-values-with-groupby-means">Replacing some values with mean of the rest of a group</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [116]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>

<span class="gp">In [117]: </span><span class="n">gb</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span>

<span class="gp">In [118]: </span><span class="k">def</span> <span class="nf">replace</span><span class="p">(</span><span class="n">g</span><span class="p">):</span>
<span class="gp">   .....: </span>    <span class="n">mask</span> <span class="o">=</span> <span class="n">g</span> <span class="o">&lt;</span> <span class="mi">0</span>
<span class="gp">   .....: </span>    <span class="k">return</span> <span class="n">g</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="o">~</span><span class="n">mask</span><span class="p">,</span> <span class="n">g</span><span class="p">[</span><span class="o">~</span><span class="n">mask</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="gp">   .....: </span>

<span class="gp">In [119]: </span><span class="n">gb</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">replace</span><span class="p">)</span>
<span class="gh">Out[119]: </span><span class="go"></span>
<span class="go">   B</span>
<span class="go">0  1</span>
<span class="go">1  1</span>
<span class="go">2  1</span>
<span class="go">3  2</span>
</pre></div>
</div>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/14941366/pandas-sort-by-group-aggregate-and-column  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/14941366/pandas-sort-by-group-aggregate-and-column'" tppabs="https://stackoverflow.com/questions/14941366/pandas-sort-by-group-aggregate-and-column">Sort groups by aggregated data</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [120]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">   .....: </span>    <span class="p">{</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;code&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="s2">&quot;baz&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.16</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.21</span><span class="p">,</span> <span class="mf">0.33</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.59</span><span class="p">,</span> <span class="mf">0.62</span><span class="p">],</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;flag&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span><span class="p">,</span>
<span class="gp">   .....: </span>    <span class="p">}</span>
<span class="gp">   .....: </span><span class="p">)</span>
<span class="gp">   .....: </span>

<span class="gp">In [121]: </span><span class="n">code_groups</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;code&quot;</span><span class="p">)</span>

<span class="gp">In [122]: </span><span class="n">agg_n_sort_order</span> <span class="o">=</span> <span class="n">code_groups</span><span class="p">[[</span><span class="s2">&quot;data&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="nb">sum</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>

<span class="gp">In [123]: </span><span class="n">sorted_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">agg_n_sort_order</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>

<span class="gp">In [124]: </span><span class="n">sorted_df</span>
<span class="gh">Out[124]: </span><span class="go"></span>
<span class="go">  code  data   flag</span>
<span class="go">1  bar -0.21   True</span>
<span class="go">4  bar -0.59  False</span>
<span class="go">0  foo  0.16  False</span>
<span class="go">3  foo  0.45   True</span>
<span class="go">2  baz  0.33  False</span>
<span class="go">5  baz  0.62   True</span>
</pre></div>
</div>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/14897100/create-multiple-columns-in-pandas-aggregation-function  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/14897100/create-multiple-columns-in-pandas-aggregation-function'" tppabs="https://stackoverflow.com/questions/14897100/create-multiple-columns-in-pandas-aggregation-function">Create multiple aggregated columns</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [125]: </span><span class="n">rng</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s2">&quot;2014-10-07&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;2min&quot;</span><span class="p">)</span>

<span class="gp">In [126]: </span><span class="n">ts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)),</span> <span class="n">index</span><span class="o">=</span><span class="n">rng</span><span class="p">)</span>

<span class="gp">In [127]: </span><span class="k">def</span> <span class="nf">MyCust</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">   .....: </span>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
<span class="gp">   .....: </span>        <span class="k">return</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.234</span>
<span class="gp">   .....: </span>    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">NaT</span>
<span class="gp">   .....: </span>

<span class="gp">In [128]: </span><span class="n">mhc</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Mean&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="s2">&quot;Max&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="s2">&quot;Custom&quot;</span><span class="p">:</span> <span class="n">MyCust</span><span class="p">}</span>

<span class="gp">In [129]: </span><span class="n">ts</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;5min&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">mhc</span><span class="p">)</span>
<span class="gh">Out[129]: </span><span class="go"></span>
<span class="go">                     Mean  Max Custom</span>
<span class="go">2014-10-07 00:00:00   1.0    2  1.234</span>
<span class="go">2014-10-07 00:05:00   3.5    4    NaT</span>
<span class="go">2014-10-07 00:10:00   6.0    7  7.404</span>
<span class="go">2014-10-07 00:15:00   8.5    9    NaT</span>

<span class="gp">In [130]: </span><span class="n">ts</span>
<span class="gh">Out[130]: </span><span class="go"></span>
<span class="go">2014-10-07 00:00:00    0</span>
<span class="go">2014-10-07 00:02:00    1</span>
<span class="go">2014-10-07 00:04:00    2</span>
<span class="go">2014-10-07 00:06:00    3</span>
<span class="go">2014-10-07 00:08:00    4</span>
<span class="go">2014-10-07 00:10:00    5</span>
<span class="go">2014-10-07 00:12:00    6</span>
<span class="go">2014-10-07 00:14:00    7</span>
<span class="go">2014-10-07 00:16:00    8</span>
<span class="go">2014-10-07 00:18:00    9</span>
<span class="go">Freq: 2T, dtype: int64</span>
</pre></div>
</div>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/q/17709270  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/q/17709270'" tppabs="https://stackoverflow.com/q/17709270">Create a value counts column and reassign back to the DataFrame</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [131]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">   .....: </span>    <span class="p">{</span><span class="s2">&quot;Color&quot;</span><span class="p">:</span> <span class="s2">&quot;Red Red Red Blue&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span> <span class="s2">&quot;Value&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">]}</span>
<span class="gp">   .....: </span><span class="p">)</span>
<span class="gp">   .....: </span>

<span class="gp">In [132]: </span><span class="n">df</span>
<span class="gh">Out[132]: </span><span class="go"></span>
<span class="go">  Color  Value</span>
<span class="go">0   Red    100</span>
<span class="go">1   Red    150</span>
<span class="go">2   Red     50</span>
<span class="go">3  Blue     50</span>

<span class="gp">In [133]: </span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Counts&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;Color&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span>

<span class="gp">In [134]: </span><span class="n">df</span>
<span class="gh">Out[134]: </span><span class="go"></span>
<span class="go">  Color  Value  Counts</span>
<span class="go">0   Red    100       3</span>
<span class="go">1   Red    150       3</span>
<span class="go">2   Red     50       3</span>
<span class="go">3  Blue     50       1</span>
</pre></div>
</div>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/q/23198053/190597  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/q/23198053/190597'" tppabs="https://stackoverflow.com/q/23198053/190597">Shift groups of the values in a column based on the index</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [135]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">   .....: </span>    <span class="p">{</span><span class="s2">&quot;line_race&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="s2">&quot;beyer&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">99</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">100</span><span class="p">]},</span>
<span class="gp">   .....: </span>    <span class="n">index</span><span class="o">=</span><span class="p">[</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;Last Gunfighter&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;Last Gunfighter&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;Last Gunfighter&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;Paynter&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;Paynter&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;Paynter&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>    <span class="p">],</span>
<span class="gp">   .....: </span><span class="p">)</span>
<span class="gp">   .....: </span>

<span class="gp">In [136]: </span><span class="n">df</span>
<span class="gh">Out[136]: </span><span class="go"></span>
<span class="go">                 line_race  beyer</span>
<span class="go">Last Gunfighter         10     99</span>
<span class="go">Last Gunfighter         10    102</span>
<span class="go">Last Gunfighter          8    103</span>
<span class="go">Paynter                 10    103</span>
<span class="go">Paynter                 10     88</span>
<span class="go">Paynter                  8    100</span>

<span class="gp">In [137]: </span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;beyer_shifted&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="s2">&quot;beyer&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">In [138]: </span><span class="n">df</span>
<span class="gh">Out[138]: </span><span class="go"></span>
<span class="go">                 line_race  beyer  beyer_shifted</span>
<span class="go">Last Gunfighter         10     99            NaN</span>
<span class="go">Last Gunfighter         10    102           99.0</span>
<span class="go">Last Gunfighter          8    103          102.0</span>
<span class="go">Paynter                 10    103            NaN</span>
<span class="go">Paynter                 10     88          103.0</span>
<span class="go">Paynter                  8    100           88.0</span>
</pre></div>
</div>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/q/26701849/190597  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/q/26701849/190597'" tppabs="https://stackoverflow.com/q/26701849/190597">Select row with maximum value from each group</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [139]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">   .....: </span>    <span class="p">{</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;other&quot;</span><span class="p">,</span> <span class="s2">&quot;other&quot;</span><span class="p">,</span> <span class="s2">&quot;that&quot;</span><span class="p">,</span> <span class="s2">&quot;this&quot;</span><span class="p">,</span> <span class="s2">&quot;this&quot;</span><span class="p">],</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;service&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mail&quot;</span><span class="p">,</span> <span class="s2">&quot;web&quot;</span><span class="p">,</span> <span class="s2">&quot;mail&quot;</span><span class="p">,</span> <span class="s2">&quot;mail&quot;</span><span class="p">,</span> <span class="s2">&quot;web&quot;</span><span class="p">],</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;no&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">   .....: </span>    <span class="p">}</span>
<span class="gp">   .....: </span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s2">&quot;host&quot;</span><span class="p">,</span> <span class="s2">&quot;service&quot;</span><span class="p">])</span>
<span class="gp">   .....: </span>

<span class="gp">In [140]: </span><span class="n">mask</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="s2">&quot;idxmax&quot;</span><span class="p">)</span>

<span class="gp">In [141]: </span><span class="n">df_count</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mask</span><span class="p">[</span><span class="s2">&quot;no&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="gp">In [142]: </span><span class="n">df_count</span>
<span class="gh">Out[142]: </span><span class="go"></span>
<span class="go">    host service  no</span>
<span class="go">0  other     web   2</span>
<span class="go">1   that    mail   1</span>
<span class="go">2   this    mail   2</span>
</pre></div>
</div>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/q/29142487/846892  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/q/29142487/846892'" tppabs="https://stackoverflow.com/q/29142487/846892">Grouping like Pythonâ€™s itertools.groupby</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [143]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">])</span>

<span class="gp">In [144]: </span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">((</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span><span class="o">.</span><span class="n">cumsum</span><span class="p">())</span><span class="o">.</span><span class="n">groups</span>
<span class="gh">Out[144]: </span><span class="go">{1: [0], 2: [1], 3: [2], 4: [3, 4, 5], 5: [6], 6: [7, 8]}</span>

<span class="gp">In [145]: </span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">((</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">())</span><span class="o">.</span><span class="n">cumsum</span><span class="p">())</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="gh">Out[145]: </span><span class="go"></span>
<span class="go">0    0</span>
<span class="go">1    1</span>
<span class="go">2    0</span>
<span class="go">3    1</span>
<span class="go">4    2</span>
<span class="go">5    3</span>
<span class="go">6    0</span>
<span class="go">7    1</span>
<span class="go">8    2</span>
<span class="go">Name: A, dtype: int64</span>
</pre></div>
</div>
<section id="expanding-data">
<h3>Expanding data<a class="headerlink" href="#expanding-data" title="Permalink to this headline">#</a></h3>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/15489011/python-time-series-alignment-and-to-date-functions  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/15489011/python-time-series-alignment-and-to-date-functions'" tppabs="https://stackoverflow.com/questions/15489011/python-time-series-alignment-and-to-date-functions">Alignment and to-date</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/14300768/pandas-rolling-computation-with-window-based-on-values-instead-of-counts  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/14300768/pandas-rolling-computation-with-window-based-on-values-instead-of-counts'" tppabs="https://stackoverflow.com/questions/14300768/pandas-rolling-computation-with-window-based-on-values-instead-of-counts">Rolling Computation window based on values instead of counts</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/15771472/pandas-rolling-mean-by-time-interval  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/15771472/pandas-rolling-mean-by-time-interval'" tppabs="https://stackoverflow.com/questions/15771472/pandas-rolling-mean-by-time-interval">Rolling Mean by Time Interval</a></p>
</section>
<section id="id2">
<h3>Splitting<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h3>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/13353233/best-way-to-split-a-dataframe-given-an-edge/15449992  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/13353233/best-way-to-split-a-dataframe-given-an-edge/15449992#15449992'" tppabs="https://stackoverflow.com/questions/13353233/best-way-to-split-a-dataframe-given-an-edge/15449992#15449992">Splitting a frame</a></p>
<p>Create a list of dataframes, split using a delineation based on logic included in rows.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [146]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">   .....: </span>    <span class="n">data</span><span class="o">=</span><span class="p">{</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;Case&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">],</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;Data&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span>
<span class="gp">   .....: </span>    <span class="p">}</span>
<span class="gp">   .....: </span><span class="p">)</span>
<span class="gp">   .....: </span>

<span class="gp">In [147]: </span><span class="n">dfs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
<span class="gp">   .....: </span>    <span class="nb">zip</span><span class="p">(</span>
<span class="gp">   .....: </span>        <span class="o">*</span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span>
<span class="gp">   .....: </span>            <span class="p">(</span><span class="mi">1</span> <span class="o">*</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Case&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;B&quot;</span><span class="p">))</span>
<span class="gp">   .....: </span>            <span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="gp">   .....: </span>            <span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">min_periods</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">   .....: </span>            <span class="o">.</span><span class="n">median</span><span class="p">()</span>
<span class="gp">   .....: </span>        <span class="p">)</span>
<span class="gp">   .....: </span>    <span class="p">)</span>
<span class="gp">   .....: </span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">   .....: </span>

<span class="gp">In [148]: </span><span class="n">dfs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gh">Out[148]: </span><span class="go"></span>
<span class="go">  Case      Data</span>
<span class="go">0    A  0.276232</span>
<span class="go">1    A -1.087401</span>
<span class="go">2    A -0.673690</span>
<span class="go">3    B  0.113648</span>

<span class="gp">In [149]: </span><span class="n">dfs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gh">Out[149]: </span><span class="go"></span>
<span class="go">  Case      Data</span>
<span class="go">4    A -1.478427</span>
<span class="go">5    A  0.524988</span>
<span class="go">6    B  0.404705</span>

<span class="gp">In [150]: </span><span class="n">dfs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="gh">Out[150]: </span><span class="go"></span>
<span class="go">  Case      Data</span>
<span class="go">7    A  0.577046</span>
<span class="go">8    A -1.715002</span>
</pre></div>
</div>
</section>
<section id="pivot">
<span id="cookbook-pivot"></span><h3>Pivot<a class="headerlink" href="#pivot" title="Permalink to this headline">#</a></h3>
<p>The <a class="reference internal" href="reshaping.html#reshaping-pivot" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/reshaping.html#reshaping-pivot"><span class="std std-ref">Pivot</span></a> docs.</p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/a/15574875  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/a/15574875'" tppabs="https://stackoverflow.com/a/15574875">Partial sums and subtotals</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [151]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">   .....: </span>    <span class="n">data</span><span class="o">=</span><span class="p">{</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;Province&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;ON&quot;</span><span class="p">,</span> <span class="s2">&quot;QC&quot;</span><span class="p">,</span> <span class="s2">&quot;BC&quot;</span><span class="p">,</span> <span class="s2">&quot;AL&quot;</span><span class="p">,</span> <span class="s2">&quot;AL&quot;</span><span class="p">,</span> <span class="s2">&quot;MN&quot;</span><span class="p">,</span> <span class="s2">&quot;ON&quot;</span><span class="p">],</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;City&quot;</span><span class="p">:</span> <span class="p">[</span>
<span class="gp">   .....: </span>            <span class="s2">&quot;Toronto&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="s2">&quot;Montreal&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="s2">&quot;Vancouver&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="s2">&quot;Calgary&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="s2">&quot;Edmonton&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="s2">&quot;Winnipeg&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="s2">&quot;Windsor&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>        <span class="p">],</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;Sales&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">   .....: </span>    <span class="p">}</span>
<span class="gp">   .....: </span><span class="p">)</span>
<span class="gp">   .....: </span>

<span class="gp">In [152]: </span><span class="n">table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
<span class="gp">   .....: </span>    <span class="n">df</span><span class="p">,</span>
<span class="gp">   .....: </span>    <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Sales&quot;</span><span class="p">],</span>
<span class="gp">   .....: </span>    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Province&quot;</span><span class="p">],</span>
<span class="gp">   .....: </span>    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;City&quot;</span><span class="p">],</span>
<span class="gp">   .....: </span>    <span class="n">aggfunc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">,</span>
<span class="gp">   .....: </span>    <span class="n">margins</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">   .....: </span><span class="p">)</span>
<span class="gp">   .....: </span>

<span class="gp">In [153]: </span><span class="n">table</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="s2">&quot;City&quot;</span><span class="p">)</span>
<span class="gh">Out[153]: </span><span class="go"></span>
<span class="go">                    Sales</span>
<span class="go">Province City            </span>
<span class="go">AL       All         12.0</span>
<span class="go">         Calgary      8.0</span>
<span class="go">         Edmonton     4.0</span>
<span class="go">BC       All         16.0</span>
<span class="go">         Vancouver   16.0</span>
<span class="go">...                   ...</span>
<span class="go">All      Montreal     6.0</span>
<span class="go">         Toronto     13.0</span>
<span class="go">         Vancouver   16.0</span>
<span class="go">         Windsor      1.0</span>
<span class="go">         Winnipeg     3.0</span>

<span class="go">[20 rows x 1 columns]</span>
</pre></div>
</div>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/15589354/frequency-tables-in-pandas-like-plyr-in-r  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/15589354/frequency-tables-in-pandas-like-plyr-in-r'" tppabs="https://stackoverflow.com/questions/15589354/frequency-tables-in-pandas-like-plyr-in-r">Frequency table like plyr in R</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [154]: </span><span class="n">grades</span> <span class="o">=</span> <span class="p">[</span><span class="mi">48</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">78</span><span class="p">]</span>

<span class="gp">In [155]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">   .....: </span>    <span class="p">{</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;ID&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;x</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)],</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;Gender&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="s2">&quot;M&quot;</span><span class="p">],</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;ExamYear&quot;</span><span class="p">:</span> <span class="p">[</span>
<span class="gp">   .....: </span>            <span class="s2">&quot;2007&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="s2">&quot;2007&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="s2">&quot;2007&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="s2">&quot;2008&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="s2">&quot;2008&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="s2">&quot;2008&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="s2">&quot;2008&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="s2">&quot;2009&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="s2">&quot;2009&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="s2">&quot;2009&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>        <span class="p">],</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;Class&quot;</span><span class="p">:</span> <span class="p">[</span>
<span class="gp">   .....: </span>            <span class="s2">&quot;algebra&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="s2">&quot;stats&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="s2">&quot;bio&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="s2">&quot;algebra&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="s2">&quot;algebra&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="s2">&quot;stats&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="s2">&quot;stats&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="s2">&quot;algebra&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="s2">&quot;bio&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="s2">&quot;bio&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>        <span class="p">],</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;Participated&quot;</span><span class="p">:</span> <span class="p">[</span>
<span class="gp">   .....: </span>            <span class="s2">&quot;yes&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="s2">&quot;yes&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="s2">&quot;yes&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="s2">&quot;yes&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="s2">&quot;no&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="s2">&quot;yes&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="s2">&quot;yes&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="s2">&quot;yes&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="s2">&quot;yes&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="s2">&quot;yes&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>        <span class="p">],</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;Passed&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;yes&quot;</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">50</span> <span class="k">else</span> <span class="s2">&quot;no&quot;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">grades</span><span class="p">],</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;Employed&quot;</span><span class="p">:</span> <span class="p">[</span>
<span class="gp">   .....: </span>            <span class="kc">True</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="kc">True</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="kc">True</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="kc">False</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="kc">False</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="kc">False</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="kc">False</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="kc">True</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="kc">True</span><span class="p">,</span>
<span class="gp">   .....: </span>            <span class="kc">False</span><span class="p">,</span>
<span class="gp">   .....: </span>        <span class="p">],</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;Grade&quot;</span><span class="p">:</span> <span class="n">grades</span><span class="p">,</span>
<span class="gp">   .....: </span>    <span class="p">}</span>
<span class="gp">   .....: </span><span class="p">)</span>
<span class="gp">   .....: </span>

<span class="gp">In [156]: </span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;ExamYear&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
<span class="gp">   .....: </span>    <span class="p">{</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;Participated&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()[</span><span class="s2">&quot;yes&quot;</span><span class="p">],</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;Passed&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;yes&quot;</span><span class="p">),</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;Employed&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">),</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;Grade&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span>
<span class="gp">   .....: </span>    <span class="p">}</span>
<span class="gp">   .....: </span><span class="p">)</span>
<span class="gp">   .....: </span>
<span class="gh">Out[156]: </span><span class="go"></span>
<span class="go">          Participated  Passed  Employed      Grade</span>
<span class="go">ExamYear                                           </span>
<span class="go">2007                 3       2         3  74.000000</span>
<span class="go">2008                 3       3         0  68.500000</span>
<span class="go">2009                 3       2         2  60.666667</span>
</pre></div>
</div>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/30379789/plot-pandas-data-frame-with-year-over-year-data  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/30379789/plot-pandas-data-frame-with-year-over-year-data'" tppabs="https://stackoverflow.com/questions/30379789/plot-pandas-data-frame-with-year-over-year-data">Plot pandas DataFrame with year over year data</a></p>
<p>To create year and month cross tabulation:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [157]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">   .....: </span>    <span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">36</span><span class="p">)},</span>
<span class="gp">   .....: </span>    <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2011-01-01&quot;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">36</span><span class="p">),</span>
<span class="gp">   .....: </span><span class="p">)</span>
<span class="gp">   .....: </span>

<span class="gp">In [158]: </span><span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
<span class="gp">   .....: </span>    <span class="n">df</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s2">&quot;sum&quot;</span>
<span class="gp">   .....: </span><span class="p">)</span>
<span class="gp">   .....: </span>
<span class="gh">Out[158]: </span><span class="go"></span>
<span class="go">        2011      2012      2013</span>
<span class="go">1  -1.039268 -0.968914  2.565646</span>
<span class="go">2  -0.370647 -1.294524  1.431256</span>
<span class="go">3  -1.157892  0.413738  1.340309</span>
<span class="go">4  -1.344312  0.276662 -1.170299</span>
<span class="go">5   0.844885 -0.472035 -0.226169</span>
<span class="go">6   1.075770 -0.013960  0.410835</span>
<span class="go">7  -0.109050 -0.362543  0.813850</span>
<span class="go">8   1.643563 -0.006154  0.132003</span>
<span class="go">9  -1.469388 -0.923061 -0.827317</span>
<span class="go">10  0.357021  0.895717 -0.076467</span>
<span class="go">11 -0.674600  0.805244 -1.187678</span>
<span class="go">12 -1.776904 -1.206412  1.130127</span>
</pre></div>
</div>
</section>
<section id="apply">
<h3>Apply<a class="headerlink" href="#apply" title="Permalink to this headline">#</a></h3>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/17349981/converting-pandas-dataframe-with-categorical-values-into-binary-values  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/17349981/converting-pandas-dataframe-with-categorical-values-into-binary-values'" tppabs="https://stackoverflow.com/questions/17349981/converting-pandas-dataframe-with-categorical-values-into-binary-values">Rolling apply to organize - Turning embedded lists into a MultiIndex frame</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [159]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">   .....: </span>    <span class="n">data</span><span class="o">=</span><span class="p">{</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">]],</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="p">[[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;jj&quot;</span><span class="p">,</span> <span class="s2">&quot;kk&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;ccc&quot;</span><span class="p">]],</span>
<span class="gp">   .....: </span>    <span class="p">},</span>
<span class="gp">   .....: </span>    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;I&quot;</span><span class="p">,</span> <span class="s2">&quot;II&quot;</span><span class="p">,</span> <span class="s2">&quot;III&quot;</span><span class="p">],</span>
<span class="gp">   .....: </span><span class="p">)</span>
<span class="gp">   .....: </span>

<span class="gp">In [160]: </span><span class="k">def</span> <span class="nf">SeriesFromSubList</span><span class="p">(</span><span class="n">aList</span><span class="p">):</span>
<span class="gp">   .....: </span>    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">aList</span><span class="p">)</span>
<span class="gp">   .....: </span>

<span class="gp">In [161]: </span><span class="n">df_orgz</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
<span class="gp">   .....: </span>    <span class="p">{</span><span class="n">ind</span><span class="p">:</span> <span class="n">row</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">SeriesFromSubList</span><span class="p">)</span> <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()}</span>
<span class="gp">   .....: </span><span class="p">)</span>
<span class="gp">   .....: </span>

<span class="gp">In [162]: </span><span class="n">df_orgz</span>
<span class="gh">Out[162]: </span><span class="go"></span>
<span class="go">         0     1     2     3</span>
<span class="go">I   A    2     4     8  16.0</span>
<span class="go">    B    a     b     c   NaN</span>
<span class="go">II  A  100   200   NaN   NaN</span>
<span class="go">    B   jj    kk   NaN   NaN</span>
<span class="go">III A   10  20.0  30.0   NaN</span>
<span class="go">    B  ccc   NaN   NaN   NaN</span>
</pre></div>
</div>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/19121854/using-rolling-apply-on-a-dataframe-object  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/19121854/using-rolling-apply-on-a-dataframe-object'" tppabs="https://stackoverflow.com/questions/19121854/using-rolling-apply-on-a-dataframe-object">Rolling apply with a DataFrame returning a Series</a></p>
<p>Rolling Apply to multiple columns where function calculates a Series before a Scalar from the Series is returned</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [163]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">   .....: </span>    <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10000</span><span class="p">,</span>
<span class="gp">   .....: </span>    <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2001-01-01&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">2000</span><span class="p">),</span>
<span class="gp">   .....: </span>    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">],</span>
<span class="gp">   .....: </span><span class="p">)</span>
<span class="gp">   .....: </span>

<span class="gp">In [164]: </span><span class="n">df</span>
<span class="gh">Out[164]: </span><span class="go"></span>
<span class="go">                   A         B</span>
<span class="go">2001-01-01 -0.000144 -0.000141</span>
<span class="go">2001-01-02  0.000161  0.000102</span>
<span class="go">2001-01-03  0.000057  0.000088</span>
<span class="go">2001-01-04 -0.000221  0.000097</span>
<span class="go">2001-01-05 -0.000201 -0.000041</span>
<span class="go">...              ...       ...</span>
<span class="go">2006-06-19  0.000040 -0.000235</span>
<span class="go">2006-06-20 -0.000123 -0.000021</span>
<span class="go">2006-06-21 -0.000113  0.000114</span>
<span class="go">2006-06-22  0.000136  0.000109</span>
<span class="go">2006-06-23  0.000027  0.000030</span>

<span class="go">[2000 rows x 2 columns]</span>

<span class="gp">In [165]: </span><span class="k">def</span> <span class="nf">gm</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">const</span><span class="p">):</span>
<span class="gp">   .....: </span>    <span class="n">v</span> <span class="o">=</span> <span class="p">((((</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">cumprod</span><span class="p">())</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">const</span>
<span class="gp">   .....: </span>    <span class="k">return</span> <span class="n">v</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">   .....: </span>

<span class="gp">In [166]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
<span class="gp">   .....: </span>    <span class="p">{</span>
<span class="gp">   .....: </span>        <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span> <span class="n">gm</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">:</span> <span class="nb">min</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">51</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)],</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">   .....: </span>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="mi">50</span><span class="p">)</span>
<span class="gp">   .....: </span>    <span class="p">}</span>
<span class="gp">   .....: </span><span class="p">)</span>
<span class="gp">   .....: </span>

<span class="gp">In [167]: </span><span class="n">s</span>
<span class="gh">Out[167]: </span><span class="go"></span>
<span class="go">2001-01-01    0.000930</span>
<span class="go">2001-01-02    0.002615</span>
<span class="go">2001-01-03    0.001281</span>
<span class="go">2001-01-04    0.001117</span>
<span class="go">2001-01-05    0.002772</span>
<span class="go">                ...   </span>
<span class="go">2006-04-30    0.003296</span>
<span class="go">2006-05-01    0.002629</span>
<span class="go">2006-05-02    0.002081</span>
<span class="go">2006-05-03    0.004247</span>
<span class="go">2006-05-04    0.003928</span>
<span class="go">Length: 1950, dtype: float64</span>
</pre></div>
</div>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/21040766/python-pandas-rolling-apply-two-column-input-into-function/21045831  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/21040766/python-pandas-rolling-apply-two-column-input-into-function/21045831#21045831'" tppabs="https://stackoverflow.com/questions/21040766/python-pandas-rolling-apply-two-column-input-into-function/21045831#21045831">Rolling apply with a DataFrame returning a Scalar</a></p>
<p>Rolling Apply to multiple columns where function returns a Scalar (Volume Weighted Average Price)</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [168]: </span><span class="n">rng</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s2">&quot;2014-01-01&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="gp">In [169]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">   .....: </span>    <span class="p">{</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;Open&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rng</span><span class="p">)),</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;Close&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rng</span><span class="p">)),</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;Volume&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">rng</span><span class="p">)),</span>
<span class="gp">   .....: </span>    <span class="p">},</span>
<span class="gp">   .....: </span>    <span class="n">index</span><span class="o">=</span><span class="n">rng</span><span class="p">,</span>
<span class="gp">   .....: </span><span class="p">)</span>
<span class="gp">   .....: </span>

<span class="gp">In [170]: </span><span class="n">df</span>
<span class="gh">Out[170]: </span><span class="go"></span>
<span class="go">                Open     Close  Volume</span>
<span class="go">2014-01-01 -1.611353 -0.492885    1219</span>
<span class="go">2014-01-02 -3.000951  0.445794    1054</span>
<span class="go">2014-01-03 -0.138359 -0.076081    1381</span>
<span class="go">2014-01-04  0.301568  1.198259    1253</span>
<span class="go">2014-01-05  0.276381 -0.669831    1728</span>
<span class="go">...              ...       ...     ...</span>
<span class="go">2014-04-06 -0.040338  0.937843    1188</span>
<span class="go">2014-04-07  0.359661 -0.285908    1864</span>
<span class="go">2014-04-08  0.060978  1.714814     941</span>
<span class="go">2014-04-09  1.759055 -0.455942    1065</span>
<span class="go">2014-04-10  0.138185 -1.147008    1453</span>

<span class="go">[100 rows x 3 columns]</span>

<span class="gp">In [171]: </span><span class="k">def</span> <span class="nf">vwap</span><span class="p">(</span><span class="n">bars</span><span class="p">):</span>
<span class="gp">   .....: </span>    <span class="k">return</span> <span class="p">(</span><span class="n">bars</span><span class="o">.</span><span class="n">Close</span> <span class="o">*</span> <span class="n">bars</span><span class="o">.</span><span class="n">Volume</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">bars</span><span class="o">.</span><span class="n">Volume</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="gp">   .....: </span>

<span class="gp">In [172]: </span><span class="n">window</span> <span class="o">=</span> <span class="mi">5</span>

<span class="gp">In [173]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
<span class="gp">   .....: </span>    <span class="p">[</span>
<span class="gp">   .....: </span>        <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">vwap</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="n">window</span><span class="p">]),</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">window</span><span class="p">]]))</span>
<span class="gp">   .....: </span>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="n">window</span><span class="p">)</span>
<span class="gp">   .....: </span>    <span class="p">]</span>
<span class="gp">   .....: </span><span class="p">)</span>
<span class="gp">   .....: </span>

<span class="gp">In [174]: </span><span class="n">s</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gh">Out[174]: </span><span class="go"></span>
<span class="go">2014-01-06    0.02</span>
<span class="go">2014-01-07    0.11</span>
<span class="go">2014-01-08    0.10</span>
<span class="go">2014-01-09    0.07</span>
<span class="go">2014-01-10   -0.29</span>
<span class="go">              ... </span>
<span class="go">2014-04-06   -0.63</span>
<span class="go">2014-04-07   -0.02</span>
<span class="go">2014-04-08   -0.03</span>
<span class="go">2014-04-09    0.34</span>
<span class="go">2014-04-10    0.29</span>
<span class="go">Length: 95, dtype: float64</span>
</pre></div>
</div>
</section>
</section>
<section id="timeseries">
<h2>Timeseries<a class="headerlink" href="#timeseries" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/14539992/pandas-drop-rows-outside-of-time-range  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/14539992/pandas-drop-rows-outside-of-time-range'" tppabs="https://stackoverflow.com/questions/14539992/pandas-drop-rows-outside-of-time-range">Between times</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/17559885/pandas-dataframe-mask-based-on-index  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/17559885/pandas-dataframe-mask-based-on-index'" tppabs="https://stackoverflow.com/questions/17559885/pandas-dataframe-mask-based-on-index">Using indexer between time</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/a/24014440  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/a/24014440'" tppabs="https://stackoverflow.com/a/24014440">Constructing a datetime range that excludes weekends and includes only certain times</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/13893227/vectorized-look-up-of-values-in-pandas-dataframe  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/13893227/vectorized-look-up-of-values-in-pandas-dataframe'" tppabs="https://stackoverflow.com/questions/13893227/vectorized-look-up-of-values-in-pandas-dataframe">Vectorized Lookup</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://nipunbatra.github.io/blog/visualisation/2013/05/01/aggregation-timeseries.html  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://nipunbatra.github.io/blog/visualisation/2013/05/01/aggregation-timeseries.html'" tppabs="https://nipunbatra.github.io/blog/visualisation/2013/05/01/aggregation-timeseries.html">Aggregation and plotting time series</a></p>
<p>Turn a matrix with hours in columns and days in rows into a continuous row sequence in the form of a time series.
<a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/15432659/how-to-rearrange-a-python-pandas-dataframe  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/15432659/how-to-rearrange-a-python-pandas-dataframe'" tppabs="https://stackoverflow.com/questions/15432659/how-to-rearrange-a-python-pandas-dataframe">How to rearrange a Python pandas DataFrame?</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/22244383/pandas-df-refill-adding-two-columns-of-different-shape  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/22244383/pandas-df-refill-adding-two-columns-of-different-shape'" tppabs="https://stackoverflow.com/questions/22244383/pandas-df-refill-adding-two-columns-of-different-shape">Dealing with duplicates when reindexing a timeseries to a specified frequency</a></p>
<p>Calculate the first day of the month for each entry in a DatetimeIndex</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [175]: </span><span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2000-01-01&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="gp">In [176]: </span><span class="n">dates</span><span class="o">.</span><span class="n">to_period</span><span class="p">(</span><span class="n">freq</span><span class="o">=</span><span class="s2">&quot;M&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_timestamp</span><span class="p">()</span>
<span class="gh">Out[176]: </span><span class="go"></span>
<span class="go">DatetimeIndex([&#39;2000-01-01&#39;, &#39;2000-01-01&#39;, &#39;2000-01-01&#39;, &#39;2000-01-01&#39;,</span>
<span class="go">               &#39;2000-01-01&#39;],</span>
<span class="go">              dtype=&#39;datetime64[ns]&#39;, freq=None)</span>
</pre></div>
</div>
<section id="resampling">
<span id="cookbook-resample"></span><h3>Resampling<a class="headerlink" href="#resampling" title="Permalink to this headline">#</a></h3>
<p>The <a class="reference internal" href="timeseries.html#timeseries-resampling" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#timeseries-resampling"><span class="std std-ref">Resample</span></a> docs.</p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/15297053/how-can-i-divide-single-values-of-a-dataframe-by-monthly-averages  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/15297053/how-can-i-divide-single-values-of-a-dataframe-by-monthly-averages'" tppabs="https://stackoverflow.com/questions/15297053/how-can-i-divide-single-values-of-a-dataframe-by-monthly-averages">Using Grouper instead of TimeGrouper for time grouping of values</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/33637312/pandas-grouper-by-frequency-with-completeness-requirement  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/33637312/pandas-grouper-by-frequency-with-completeness-requirement'" tppabs="https://stackoverflow.com/questions/33637312/pandas-grouper-by-frequency-with-completeness-requirement">Time grouping with some missing values</a></p>
<p>Valid frequency arguments to Grouper <a class="reference internal" href="timeseries.html#timeseries-offset-aliases" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#timeseries-offset-aliases"><span class="std std-ref">Timeseries</span></a></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/41483763/pandas-timegrouper-on-multiindex  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/41483763/pandas-timegrouper-on-multiindex'" tppabs="https://stackoverflow.com/questions/41483763/pandas-timegrouper-on-multiindex">Grouping using a MultiIndex</a></p>
<p>Using TimeGrouper and another grouping to create subgroups, then apply a custom function <a class="reference external" href="javascript:if(confirm('https://github.com/pandas-dev/pandas/issues/3791  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/pandas-dev/pandas/issues/3791'" tppabs="https://github.com/pandas-dev/pandas/issues/3791">GH3791</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/15408156/resampling-with-custom-periods  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/15408156/resampling-with-custom-periods'" tppabs="https://stackoverflow.com/questions/15408156/resampling-with-custom-periods">Resampling with custom periods</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/14898574/resample-intrday-pandas-dataframe-without-add-new-days  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/14898574/resample-intrday-pandas-dataframe-without-add-new-days'" tppabs="https://stackoverflow.com/questions/14898574/resample-intrday-pandas-dataframe-without-add-new-days">Resample intraday frame without adding new days</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/14861023/resampling-minute-data  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/14861023/resampling-minute-data'" tppabs="https://stackoverflow.com/questions/14861023/resampling-minute-data">Resample minute data</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/q/18677271/564538  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/q/18677271/564538'" tppabs="https://stackoverflow.com/q/18677271/564538">Resample with groupby</a></p>
</section>
</section>
<section id="merge">
<span id="cookbook-merge"></span><h2>Merge<a class="headerlink" href="#merge" title="Permalink to this headline">#</a></h2>
<p>The <a class="reference internal" href="merging.html#merging-join" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/merging.html#merging-join"><span class="std std-ref">Join</span></a> docs.</p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/14988480/pandas-version-of-rbind  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/14988480/pandas-version-of-rbind'" tppabs="https://stackoverflow.com/questions/14988480/pandas-version-of-rbind">Concatenate two dataframes with overlapping index (emulate R rbind)</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [177]: </span><span class="n">rng</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2000-01-01&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>

<span class="gp">In [178]: </span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">rng</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">])</span>

<span class="gp">In [179]: </span><span class="n">df2</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
<p>Depending on df construction, <code class="docutils literal notranslate"><span class="pre">ignore_index</span></code> may be needed</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [180]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="gp">In [181]: </span><span class="n">df</span>
<span class="gh">Out[181]: </span><span class="go"></span>
<span class="go">           A         B         C</span>
<span class="go">0  -0.870117 -0.479265 -0.790855</span>
<span class="go">1   0.144817  1.726395 -0.464535</span>
<span class="go">2  -0.821906  1.597605  0.187307</span>
<span class="go">3  -0.128342 -1.511638 -0.289858</span>
<span class="go">4   0.399194 -1.430030 -0.639760</span>
<span class="go">5   1.115116 -2.012600  1.810662</span>
<span class="go">6  -0.870117 -0.479265 -0.790855</span>
<span class="go">7   0.144817  1.726395 -0.464535</span>
<span class="go">8  -0.821906  1.597605  0.187307</span>
<span class="go">9  -0.128342 -1.511638 -0.289858</span>
<span class="go">10  0.399194 -1.430030 -0.639760</span>
<span class="go">11  1.115116 -2.012600  1.810662</span>
</pre></div>
</div>
<p>Self Join of a DataFrame <a class="reference external" href="javascript:if(confirm('https://github.com/pandas-dev/pandas/issues/2996  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/pandas-dev/pandas/issues/2996'" tppabs="https://github.com/pandas-dev/pandas/issues/2996">GH2996</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [182]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">   .....: </span>    <span class="n">data</span><span class="o">=</span><span class="p">{</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;Area&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;Bins&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">110</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">[</span><span class="mi">160</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="p">[</span><span class="mi">40</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;Test_0&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;Data&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span>
<span class="gp">   .....: </span>    <span class="p">}</span>
<span class="gp">   .....: </span><span class="p">)</span>
<span class="gp">   .....: </span>

<span class="gp">In [183]: </span><span class="n">df</span>
<span class="gh">Out[183]: </span><span class="go"></span>
<span class="go">  Area  Bins  Test_0      Data</span>
<span class="go">0    A   110       0 -0.433937</span>
<span class="go">1    A   110       1 -0.160552</span>
<span class="go">2    A   160       0  0.744434</span>
<span class="go">3    A   160       1  1.754213</span>
<span class="go">4    A   160       2  0.000850</span>
<span class="go">5    C    40       0  0.342243</span>
<span class="go">6    C    40       1  1.070599</span>

<span class="gp">In [184]: </span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Test_1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;Test_0&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>

<span class="gp">In [185]: </span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
<span class="gp">   .....: </span>    <span class="n">df</span><span class="p">,</span>
<span class="gp">   .....: </span>    <span class="n">df</span><span class="p">,</span>
<span class="gp">   .....: </span>    <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Bins&quot;</span><span class="p">,</span> <span class="s2">&quot;Area&quot;</span><span class="p">,</span> <span class="s2">&quot;Test_0&quot;</span><span class="p">],</span>
<span class="gp">   .....: </span>    <span class="n">right_on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Bins&quot;</span><span class="p">,</span> <span class="s2">&quot;Area&quot;</span><span class="p">,</span> <span class="s2">&quot;Test_1&quot;</span><span class="p">],</span>
<span class="gp">   .....: </span>    <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;_L&quot;</span><span class="p">,</span> <span class="s2">&quot;_R&quot;</span><span class="p">),</span>
<span class="gp">   .....: </span><span class="p">)</span>
<span class="gp">   .....: </span>
<span class="gh">Out[185]: </span><span class="go"></span>
<span class="go">  Area  Bins  Test_0_L    Data_L  Test_1_L  Test_0_R    Data_R  Test_1_R</span>
<span class="go">0    A   110         0 -0.433937        -1         1 -0.160552         0</span>
<span class="go">1    A   160         0  0.744434        -1         1  1.754213         0</span>
<span class="go">2    A   160         1  1.754213         0         2  0.000850         1</span>
<span class="go">3    C    40         0  0.342243        -1         1  1.070599         0</span>
</pre></div>
</div>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/14341805/pandas-merge-pd-merge-how-to-set-the-index-and-join  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/14341805/pandas-merge-pd-merge-how-to-set-the-index-and-join'" tppabs="https://stackoverflow.com/questions/14341805/pandas-merge-pd-merge-how-to-set-the-index-and-join">How to set the index and join</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/12322289/kdb-like-asof-join-for-timeseries-data-in-pandas/12336039  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/12322289/kdb-like-asof-join-for-timeseries-data-in-pandas/12336039#12336039'" tppabs="https://stackoverflow.com/questions/12322289/kdb-like-asof-join-for-timeseries-data-in-pandas/12336039#12336039">KDB like asof join</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/15581829/how-to-perform-an-inner-or-outer-join-of-dataframes-with-pandas-on-non-simplisti  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/15581829/how-to-perform-an-inner-or-outer-join-of-dataframes-with-pandas-on-non-simplisti'" tppabs="https://stackoverflow.com/questions/15581829/how-to-perform-an-inner-or-outer-join-of-dataframes-with-pandas-on-non-simplisti">Join with a criteria based on the values</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/25125626/pandas-merge-with-logic/2512764  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/25125626/pandas-merge-with-logic/2512764'" tppabs="https://stackoverflow.com/questions/25125626/pandas-merge-with-logic/2512764">Using searchsorted to merge based on values inside a range</a></p>
</section>
<section id="plotting">
<span id="cookbook-plotting"></span><h2>Plotting<a class="headerlink" href="#plotting" title="Permalink to this headline">#</a></h2>
<p>The <a class="reference internal" href="visualization.html#visualization" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/visualization.html#visualization"><span class="std std-ref">Plotting</span></a> docs.</p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/14349055/making-matplotlib-graphs-look-like-r-by-default  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/14349055/making-matplotlib-graphs-look-like-r-by-default'" tppabs="https://stackoverflow.com/questions/14349055/making-matplotlib-graphs-look-like-r-by-default">Make Matplotlib look like R</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/12945971/pandas-timeseries-plot-setting-x-axis-major-and-minor-ticks-and-labels  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/12945971/pandas-timeseries-plot-setting-x-axis-major-and-minor-ticks-and-labels'" tppabs="https://stackoverflow.com/questions/12945971/pandas-timeseries-plot-setting-x-axis-major-and-minor-ticks-and-labels">Setting x-axis major and minor labels</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/16392921/make-more-than-one-chart-in-same-ipython-notebook-cell  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/16392921/make-more-than-one-chart-in-same-ipython-notebook-cell'" tppabs="https://stackoverflow.com/questions/16392921/make-more-than-one-chart-in-same-ipython-notebook-cell">Plotting multiple charts in an IPython Jupyter notebook</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/16568964/make-a-multiline-plot-from-csv-file-in-matplotlib  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/16568964/make-a-multiline-plot-from-csv-file-in-matplotlib'" tppabs="https://stackoverflow.com/questions/16568964/make-a-multiline-plot-from-csv-file-in-matplotlib">Creating a multi-line plot</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/17050202/plot-timeseries-of-histograms-in-python  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/17050202/plot-timeseries-of-histograms-in-python'" tppabs="https://stackoverflow.com/questions/17050202/plot-timeseries-of-histograms-in-python">Plotting a heatmap</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/11067368/annotate-time-series-plot-in-matplotlib  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/11067368/annotate-time-series-plot-in-matplotlib'" tppabs="https://stackoverflow.com/questions/11067368/annotate-time-series-plot-in-matplotlib">Annotate a time-series plot</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/17891493/annotating-points-from-a-pandas-dataframe-in-matplotlib-plot  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/17891493/annotating-points-from-a-pandas-dataframe-in-matplotlib-plot'" tppabs="https://stackoverflow.com/questions/17891493/annotating-points-from-a-pandas-dataframe-in-matplotlib-plot">Annotate a time-series plot #2</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://pandas-xlsxwriter-charts.readthedocs.io/  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://pandas-xlsxwriter-charts.readthedocs.io/'" tppabs="https://pandas-xlsxwriter-charts.readthedocs.io/">Generate Embedded plots in excel files using Pandas, Vincent and xlsxwriter</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/23232989/boxplot-stratified-by-column-in-python-pandas  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/23232989/boxplot-stratified-by-column-in-python-pandas'" tppabs="https://stackoverflow.com/questions/23232989/boxplot-stratified-by-column-in-python-pandas">Boxplot for each quartile of a stratifying variable</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [186]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
<span class="gp">   .....: </span>    <span class="p">{</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;stratifying_var&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
<span class="gp">   .....: </span>        <span class="s2">&quot;price&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
<span class="gp">   .....: </span>    <span class="p">}</span>
<span class="gp">   .....: </span><span class="p">)</span>
<span class="gp">   .....: </span>

<span class="gp">In [187]: </span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;quartiles&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">qcut</span><span class="p">(</span>
<span class="gp">   .....: </span>    <span class="n">df</span><span class="p">[</span><span class="s2">&quot;stratifying_var&quot;</span><span class="p">],</span> <span class="mi">4</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;0-25%&quot;</span><span class="p">,</span> <span class="s2">&quot;25-50%&quot;</span><span class="p">,</span> <span class="s2">&quot;50-75%&quot;</span><span class="p">,</span> <span class="s2">&quot;75-100%&quot;</span><span class="p">]</span>
<span class="gp">   .....: </span><span class="p">)</span>
<span class="gp">   .....: </span>

<span class="gp">In [188]: </span><span class="n">df</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s2">&quot;price&quot;</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s2">&quot;quartiles&quot;</span><span class="p">)</span>
<span class="gh">Out[188]: </span><span class="go">&lt;AxesSubplot: title={&#39;center&#39;: &#39;price&#39;}, xlabel=&#39;quartiles&#39;&gt;</span>
</pre></div>
</div>
<img alt="../_images/quartile_boxplot.png" src="quartile_boxplot.png" tppabs="https://pandas.pydata.org/pandas-docs/stable/_images/quartile_boxplot.png" />
</section>
<section id="data-in-out">
<h2>Data in/out<a class="headerlink" href="#data-in-out" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/q/16628329  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/q/16628329'" tppabs="https://stackoverflow.com/q/16628329">Performance comparison of SQL vs HDF5</a></p>
<section id="csv">
<span id="cookbook-csv"></span><h3>CSV<a class="headerlink" href="#csv" title="Permalink to this headline">#</a></h3>
<p>The <a class="reference internal" href="io.html#io-read-csv-table" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/io.html#io-read-csv-table"><span class="std std-ref">CSV</span></a> docs</p>
<p><a class="reference external" href="javascript:if(confirm('https://wesmckinney.com/blog/update-on-upcoming-pandas-v0-10-new-file-parser-other-performance-wins/  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://wesmckinney.com/blog/update-on-upcoming-pandas-v0-10-new-file-parser-other-performance-wins/'" tppabs="https://wesmckinney.com/blog/update-on-upcoming-pandas-v0-10-new-file-parser-other-performance-wins/">read_csv in action</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/17134942/pandas-dataframe-output-end-of-csv  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/17134942/pandas-dataframe-output-end-of-csv'" tppabs="https://stackoverflow.com/questions/17134942/pandas-dataframe-output-end-of-csv">appending to a csv</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/11622652/large-persistent-dataframe-in-pandas/12193309  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/11622652/large-persistent-dataframe-in-pandas/12193309#12193309'" tppabs="https://stackoverflow.com/questions/11622652/large-persistent-dataframe-in-pandas/12193309#12193309">Reading a csv chunk-by-chunk</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/19674212/pandas-data-frame-select-rows-and-clear-memory  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/19674212/pandas-data-frame-select-rows-and-clear-memory'" tppabs="https://stackoverflow.com/questions/19674212/pandas-data-frame-select-rows-and-clear-memory">Reading only certain rows of a csv chunk-by-chunk</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/15008970/way-to-read-first-few-lines-for-pandas-dataframe  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/15008970/way-to-read-first-few-lines-for-pandas-dataframe'" tppabs="https://stackoverflow.com/questions/15008970/way-to-read-first-few-lines-for-pandas-dataframe">Reading the first few lines of a frame</a></p>
<p>Reading a file that is compressed but not by <code class="docutils literal notranslate"><span class="pre">gzip/bz2</span></code> (the native compressed formats which <code class="docutils literal notranslate"><span class="pre">read_csv</span></code> understands).
This example shows a <code class="docutils literal notranslate"><span class="pre">WinZipped</span></code> file, but is a general application of opening the file within a context manager and
using that handle to read.
<a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/17789907/pandas-convert-winzipped-csv-file-to-data-frame  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/17789907/pandas-convert-winzipped-csv-file-to-data-frame'" tppabs="https://stackoverflow.com/questions/17789907/pandas-convert-winzipped-csv-file-to-data-frame">See here</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/15555005/get-inferred-dataframe-types-iteratively-using-chunksize  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/15555005/get-inferred-dataframe-types-iteratively-using-chunksize'" tppabs="https://stackoverflow.com/questions/15555005/get-inferred-dataframe-types-iteratively-using-chunksize">Inferring dtypes from a file</a></p>
<p>Dealing with bad lines <a class="reference external" href="javascript:if(confirm('https://github.com/pandas-dev/pandas/issues/2886  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/pandas-dev/pandas/issues/2886'" tppabs="https://github.com/pandas-dev/pandas/issues/2886">GH2886</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/17349574/pandas-write-multiindex-rows-with-to-csv  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/17349574/pandas-write-multiindex-rows-with-to-csv'" tppabs="https://stackoverflow.com/questions/17349574/pandas-write-multiindex-rows-with-to-csv">Write a multi-row index CSV without writing duplicates</a></p>
<section id="reading-multiple-files-to-create-a-single-dataframe">
<span id="cookbook-csv-multiple-files"></span><h4>Reading multiple files to create a single DataFrame<a class="headerlink" href="#reading-multiple-files-to-create-a-single-dataframe" title="Permalink to this headline">#</a></h4>
<p>The best way to combine multiple files into a single DataFrame is to read the individual frames one by one, put all
of the individual frames into a list, and then combine the frames in the list using <code class="xref py py-func docutils literal notranslate"><span class="pre">pd.concat()</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [189]: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
<span class="gp">   .....: </span>    <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="gp">   .....: </span>    <span class="n">data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;file_</span><span class="si">{}</span><span class="s2">.csv&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<span class="gp">   .....: </span>

<span class="gp">In [190]: </span><span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;file_0.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;file_1.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;file_2.csv&quot;</span><span class="p">]</span>

<span class="gp">In [191]: </span><span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>You can use the same approach to read all files matching a pattern. Here is an example using <code class="docutils literal notranslate"><span class="pre">glob</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [192]: </span><span class="kn">import</span> <span class="nn">glob</span>

<span class="gp">In [193]: </span><span class="kn">import</span> <span class="nn">os</span>

<span class="gp">In [194]: </span><span class="n">files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;file_*.csv&quot;</span><span class="p">)</span>

<span class="gp">In [195]: </span><span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally, this strategy will work with the other <code class="docutils literal notranslate"><span class="pre">pd.read_*(...)</span></code> functions described in the <a class="reference internal" href="io.html#io" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/io.html#io"><span class="std std-ref">io docs</span></a>.</p>
</section>
<section id="parsing-date-components-in-multi-columns">
<h4>Parsing date components in multi-columns<a class="headerlink" href="#parsing-date-components-in-multi-columns" title="Permalink to this headline">#</a></h4>
<p>Parsing date components in multi-columns is faster with a format</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [196]: </span><span class="n">i</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;20000101&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>

<span class="gp">In [197]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="n">i</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="s2">&quot;month&quot;</span><span class="p">:</span> <span class="n">i</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="s2">&quot;day&quot;</span><span class="p">:</span> <span class="n">i</span><span class="o">.</span><span class="n">day</span><span class="p">})</span>

<span class="gp">In [198]: </span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="gh">Out[198]: </span><span class="go"></span>
<span class="go">   year  month  day</span>
<span class="go">0  2000      1    1</span>
<span class="go">1  2000      1    2</span>
<span class="go">2  2000      1    3</span>
<span class="go">3  2000      1    4</span>
<span class="go">4  2000      1    5</span>

<span class="gp">In [199]: </span><span class="o">%</span><span class="k">timeit</span> pd.to_datetime(df.year * 10000 + df.month * 100 + df.day, format=&#39;%Y%m%d&#39;)
<span class="gp">   .....: </span><span class="n">ds</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">%04d%02d%02d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;month&quot;</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;day&quot;</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">   .....: </span><span class="n">ds</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="gp">   .....: </span><span class="o">%</span><span class="k">timeit</span> pd.to_datetime(ds)
<span class="gp">   .....: </span>
<span class="go">5.48 ms +- 85.9 us per loop (mean +- std. dev. of 7 runs, 100 loops each)</span>
<span class="go">1.41 ms +- 3.1 us per loop (mean +- std. dev. of 7 runs, 1,000 loops each)</span>
</pre></div>
</div>
</section>
<section id="skip-row-between-header-and-data">
<h4>Skip row between header and data<a class="headerlink" href="#skip-row-between-header-and-data" title="Permalink to this headline">#</a></h4>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [200]: </span><span class="n">data</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;;;;;</span>
<span class="gp">   .....: </span><span class="s2"> ;;;;</span>
<span class="gp">   .....: </span><span class="s2"> ;;;;</span>
<span class="gp">   .....: </span><span class="s2"> ;;;;</span>
<span class="gp">   .....: </span><span class="s2"> ;;;;</span>
<span class="gp">   .....: </span><span class="s2"> ;;;;</span>
<span class="gp">   .....: </span><span class="s2">;;;;</span>
<span class="gp">   .....: </span><span class="s2"> ;;;;</span>
<span class="gp">   .....: </span><span class="s2"> ;;;;</span>
<span class="gp">   .....: </span><span class="s2">;;;;</span>
<span class="gp">   .....: </span><span class="s2">date;Param1;Param2;Param4;Param5</span>
<span class="gp">   .....: </span><span class="s2">    ;mÂ²;Â°C;mÂ²;m</span>
<span class="gp">   .....: </span><span class="s2">;;;;</span>
<span class="gp">   .....: </span><span class="s2">01.01.1990 00:00;1;1;2;3</span>
<span class="gp">   .....: </span><span class="s2">01.01.1990 01:00;5;3;4;5</span>
<span class="gp">   .....: </span><span class="s2">01.01.1990 02:00;9;5;6;7</span>
<span class="gp">   .....: </span><span class="s2">01.01.1990 03:00;13;7;8;9</span>
<span class="gp">   .....: </span><span class="s2">01.01.1990 04:00;17;9;10;11</span>
<span class="gp">   .....: </span><span class="s2">01.01.1990 05:00;21;11;12;13</span>
<span class="gp">   .....: </span><span class="s2">&quot;&quot;&quot;</span>
<span class="gp">   .....: </span>
</pre></div>
</div>
<section id="option-1-pass-rows-explicitly-to-skip-rows">
<h5>Option 1: pass rows explicitly to skip rows<a class="headerlink" href="#option-1-pass-rows-explicitly-to-skip-rows" title="Permalink to this headline">#</a></h5>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [201]: </span><span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">StringIO</span>

<span class="gp">In [202]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
<span class="gp">   .....: </span>    <span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">),</span>
<span class="gp">   .....: </span>    <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">,</span>
<span class="gp">   .....: </span>    <span class="n">skiprows</span><span class="o">=</span><span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>
<span class="gp">   .....: </span>    <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="gp">   .....: </span>    <span class="n">parse_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">   .....: </span>    <span class="n">header</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">   .....: </span><span class="p">)</span>
<span class="gp">   .....: </span>
<span class="gh">Out[202]: </span><span class="go"></span>
<span class="go">                     Param1  Param2  Param4  Param5</span>
<span class="go">date                                               </span>
<span class="go">1990-01-01 00:00:00       1       1       2       3</span>
<span class="go">1990-01-01 01:00:00       5       3       4       5</span>
<span class="go">1990-01-01 02:00:00       9       5       6       7</span>
<span class="go">1990-01-01 03:00:00      13       7       8       9</span>
<span class="go">1990-01-01 04:00:00      17       9      10      11</span>
<span class="go">1990-01-01 05:00:00      21      11      12      13</span>
</pre></div>
</div>
</section>
<section id="option-2-read-column-names-and-then-data">
<h5>Option 2: read column names and then data<a class="headerlink" href="#option-2-read-column-names-and-then-data" title="Permalink to this headline">#</a></h5>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [203]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span>
<span class="gh">Out[203]: </span><span class="go">Index([&#39;date&#39;, &#39;Param1&#39;, &#39;Param2&#39;, &#39;Param4&#39;, &#39;Param5&#39;], dtype=&#39;object&#39;)</span>

<span class="gp">In [204]: </span><span class="n">columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span>

<span class="gp">In [205]: </span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
<span class="gp">   .....: </span>    <span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;;&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">columns</span>
<span class="gp">   .....: </span><span class="p">)</span>
<span class="gp">   .....: </span>
<span class="gh">Out[205]: </span><span class="go"></span>
<span class="go">                     Param1  Param2  Param4  Param5</span>
<span class="go">date                                               </span>
<span class="go">1990-01-01 00:00:00       1       1       2       3</span>
<span class="go">1990-01-01 01:00:00       5       3       4       5</span>
<span class="go">1990-01-01 02:00:00       9       5       6       7</span>
<span class="go">1990-01-01 03:00:00      13       7       8       9</span>
<span class="go">1990-01-01 04:00:00      17       9      10      11</span>
<span class="go">1990-01-01 05:00:00      21      11      12      13</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="sql">
<span id="cookbook-sql"></span><h3>SQL<a class="headerlink" href="#sql" title="Permalink to this headline">#</a></h3>
<p>The <a class="reference internal" href="io.html#io-sql" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/io.html#io-sql"><span class="std std-ref">SQL</span></a> docs</p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/10065051/python-pandas-and-databases-like-mysql  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/10065051/python-pandas-and-databases-like-mysql'" tppabs="https://stackoverflow.com/questions/10065051/python-pandas-and-databases-like-mysql">Reading from databases with SQL</a></p>
</section>
<section id="excel">
<span id="cookbook-excel"></span><h3>Excel<a class="headerlink" href="#excel" title="Permalink to this headline">#</a></h3>
<p>The <a class="reference internal" href="io.html#io-excel" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/io.html#io-excel"><span class="std std-ref">Excel</span></a> docs</p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/15588713/sheets-of-excel-workbook-from-a-url-into-a-pandas-dataframe  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/15588713/sheets-of-excel-workbook-from-a-url-into-a-pandas-dataframe'" tppabs="https://stackoverflow.com/questions/15588713/sheets-of-excel-workbook-from-a-url-into-a-pandas-dataframe">Reading from a filelike handle</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://pbpython.com/improve-pandas-excel-output.html  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://pbpython.com/improve-pandas-excel-output.html'" tppabs="https://pbpython.com/improve-pandas-excel-output.html">Modifying formatting in XlsxWriter output</a></p>
<p>Loading only visible sheets <a class="reference external" href="javascript:if(confirm('https://github.com/pandas-dev/pandas/issues/19842  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/pandas-dev/pandas/issues/19842#issuecomment-892150745'" tppabs="https://github.com/pandas-dev/pandas/issues/19842#issuecomment-892150745">GH19842#issuecomment-892150745</a></p>
</section>
<section id="html">
<span id="cookbook-html"></span><h3>HTML<a class="headerlink" href="#html" title="Permalink to this headline">#</a></h3>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/a/18939272/564538  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/a/18939272/564538'" tppabs="https://stackoverflow.com/a/18939272/564538">Reading HTML tables from a server that cannot handle the default request
header</a></p>
</section>
<section id="hdfstore">
<span id="cookbook-hdf"></span><h3>HDFStore<a class="headerlink" href="#hdfstore" title="Permalink to this headline">#</a></h3>
<p>The <a class="reference internal" href="io.html#io-hdf5" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/io.html#io-hdf5"><span class="std std-ref">HDFStores</span></a> docs</p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/13926089/selecting-columns-from-pandas-hdfstore-table  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/13926089/selecting-columns-from-pandas-hdfstore-table'" tppabs="https://stackoverflow.com/questions/13926089/selecting-columns-from-pandas-hdfstore-table">Simple queries with a Timestamp Index</a></p>
<p>Managing heterogeneous data using a linked multiple table hierarchy <a class="reference external" href="javascript:if(confirm('https://github.com/pandas-dev/pandas/issues/3032  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/pandas-dev/pandas/issues/3032'" tppabs="https://github.com/pandas-dev/pandas/issues/3032">GH3032</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/14614512/merging-two-tables-with-millions-of-rows-in-python/14617925  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/14614512/merging-two-tables-with-millions-of-rows-in-python/14617925#14617925'" tppabs="https://stackoverflow.com/questions/14614512/merging-two-tables-with-millions-of-rows-in-python/14617925#14617925">Merging on-disk tables with millions of rows</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/a/29014295/2858145  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/a/29014295/2858145'" tppabs="https://stackoverflow.com/a/29014295/2858145">Avoiding inconsistencies when writing to a store from multiple processes/threads</a></p>
<p>De-duplicating a large store by chunks, essentially a recursive reduction operation. Shows a function for taking in data from
csv file and creating a store by chunks, with date parsing as well.
<a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/16110252/need-to-compare-very-large-files-around-1-5gb-in-python/16110391  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/16110252/need-to-compare-very-large-files-around-1-5gb-in-python/16110391#16110391'" tppabs="https://stackoverflow.com/questions/16110252/need-to-compare-very-large-files-around-1-5gb-in-python/16110391#16110391">See here</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/20428355/appending-column-to-frame-of-hdf-file-in-pandas/20428786  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/20428355/appending-column-to-frame-of-hdf-file-in-pandas/20428786#20428786'" tppabs="https://stackoverflow.com/questions/20428355/appending-column-to-frame-of-hdf-file-in-pandas/20428786#20428786">Creating a store chunk-by-chunk from a csv file</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/16997048/how-does-one-append-large-amounts-of-data-to-a-pandas-hdfstore-and-get-a-natural/16999397  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/16997048/how-does-one-append-large-amounts-of-data-to-a-pandas-hdfstore-and-get-a-natural/16999397#16999397'" tppabs="https://stackoverflow.com/questions/16997048/how-does-one-append-large-amounts-of-data-to-a-pandas-hdfstore-and-get-a-natural/16999397#16999397">Appending to a store, while creating a unique index</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/q/14262433  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/q/14262433'" tppabs="https://stackoverflow.com/q/14262433">Large Data work flows</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/16997048/how-does-one-append-large-amounts-of-data-to-a-pandas-hdfstore-and-get-a-natural  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/16997048/how-does-one-append-large-amounts-of-data-to-a-pandas-hdfstore-and-get-a-natural'" tppabs="https://stackoverflow.com/questions/16997048/how-does-one-append-large-amounts-of-data-to-a-pandas-hdfstore-and-get-a-natural">Reading in a sequence of files, then providing a global unique index to a store while appending</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/15798209/pandas-group-by-query-on-large-data-in-hdfstore  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/15798209/pandas-group-by-query-on-large-data-in-hdfstore'" tppabs="https://stackoverflow.com/questions/15798209/pandas-group-by-query-on-large-data-in-hdfstore">Groupby on a HDFStore with low group density</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/25459982/trouble-with-grouby-on-millions-of-keys-on-a-chunked-file-in-python-pandas/25471765  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/25459982/trouble-with-grouby-on-millions-of-keys-on-a-chunked-file-in-python-pandas/25471765#25471765'" tppabs="https://stackoverflow.com/questions/25459982/trouble-with-grouby-on-millions-of-keys-on-a-chunked-file-in-python-pandas/25471765#25471765">Groupby on a HDFStore with high group density</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/22777284/improve-query-performance-from-a-large-hdfstore-table-with-pandas/22820780  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/22777284/improve-query-performance-from-a-large-hdfstore-table-with-pandas/22820780#22820780'" tppabs="https://stackoverflow.com/questions/22777284/improve-query-performance-from-a-large-hdfstore-table-with-pandas/22820780#22820780">Hierarchical queries on a HDFStore</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/20497897/converting-dict-of-dicts-into-pandas-dataframe-memory-issues  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/20497897/converting-dict-of-dicts-into-pandas-dataframe-memory-issues'" tppabs="https://stackoverflow.com/questions/20497897/converting-dict-of-dicts-into-pandas-dataframe-memory-issues">Counting with a HDFStore</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/15488809/how-to-trouble-shoot-hdfstore-exception-cannot-find-the-correct-atom-type  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/15488809/how-to-trouble-shoot-hdfstore-exception-cannot-find-the-correct-atom-type'" tppabs="https://stackoverflow.com/questions/15488809/how-to-trouble-shoot-hdfstore-exception-cannot-find-the-correct-atom-type">Troubleshoot HDFStore exceptions</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/15988871/hdfstore-appendstring-dataframe-fails-when-string-column-contents-are-longer  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/15988871/hdfstore-appendstring-dataframe-fails-when-string-column-contents-are-longer'" tppabs="https://stackoverflow.com/questions/15988871/hdfstore-appendstring-dataframe-fails-when-string-column-contents-are-longer">Setting min_itemsize with strings</a></p>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/17893370/ptrepack-sortby-needs-full-index  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/17893370/ptrepack-sortby-needs-full-index'" tppabs="https://stackoverflow.com/questions/17893370/ptrepack-sortby-needs-full-index">Using ptrepack to create a completely-sorted-index on a store</a></p>
<p>Storing Attributes to a group node</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [206]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="gp">In [207]: </span><span class="n">store</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">HDFStore</span><span class="p">(</span><span class="s2">&quot;test.h5&quot;</span><span class="p">)</span>

<span class="gp">In [208]: </span><span class="n">store</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="s2">&quot;df&quot;</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>

<span class="go"># you can store an arbitrary Python object via pickle</span>
<span class="gp">In [209]: </span><span class="n">store</span><span class="o">.</span><span class="n">get_storer</span><span class="p">(</span><span class="s2">&quot;df&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">my_attribute</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>

<span class="gp">In [210]: </span><span class="n">store</span><span class="o">.</span><span class="n">get_storer</span><span class="p">(</span><span class="s2">&quot;df&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">my_attribute</span>
<span class="gh">Out[210]: </span><span class="go">{&#39;A&#39;: 10}</span>
</pre></div>
</div>
<p>You can create or load a HDFStore in-memory by passing the <code class="docutils literal notranslate"><span class="pre">driver</span></code>
parameter to PyTables. Changes are only written to disk when the HDFStore
is closed.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [211]: </span><span class="n">store</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">HDFStore</span><span class="p">(</span><span class="s2">&quot;test.h5&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="s2">&quot;H5FD_CORE&quot;</span><span class="p">)</span>

<span class="gp">In [212]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="gp">In [213]: </span><span class="n">store</span><span class="p">[</span><span class="s2">&quot;test&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span>

<span class="go"># only after closing the store, data is written to disk:</span>
<span class="gp">In [214]: </span><span class="n">store</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="binary-files">
<span id="cookbook-binary"></span><h3>Binary files<a class="headerlink" href="#binary-files" title="Permalink to this headline">#</a></h3>
<p>pandas readily accepts NumPy record arrays, if you need to read in a binary
file consisting of an array of C structs. For example, given this C program
in a file called <code class="docutils literal notranslate"><span class="pre">main.c</span></code> compiled with <code class="docutils literal notranslate"><span class="pre">gcc</span> <span class="pre">main.c</span> <span class="pre">-std=gnu99</span></code> on a
64-bit machine,</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdint.h&gt;</span><span class="cp"></span>

<span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">_Data</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">int32_t</span><span class="w"> </span><span class="n">count</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">avg</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">scale</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"> </span><span class="n">Data</span><span class="p">;</span><span class="w"></span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">argv</span><span class="p">[])</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Data</span><span class="w"> </span><span class="n">d</span><span class="p">[</span><span class="n">n</span><span class="p">];</span><span class="w"></span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">avg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">scale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">2.0f</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="kt">FILE</span><span class="w"> </span><span class="o">*</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fopen</span><span class="p">(</span><span class="s">&quot;binary.dat&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;wb&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">fwrite</span><span class="p">(</span><span class="o">&amp;</span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">Data</span><span class="p">),</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">fclose</span><span class="p">(</span><span class="n">file</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>the following Python code will read the binary file <code class="docutils literal notranslate"><span class="pre">'binary.dat'</span></code> into a
pandas <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, where each element of the struct corresponds to a column
in the frame:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">names</span> <span class="o">=</span> <span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="s2">&quot;avg&quot;</span><span class="p">,</span> <span class="s2">&quot;scale&quot;</span>

<span class="c1"># note that the offsets are larger than the size of the type because of</span>
<span class="c1"># struct padding</span>
<span class="n">offsets</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span>
<span class="n">formats</span> <span class="o">=</span> <span class="s2">&quot;i4&quot;</span><span class="p">,</span> <span class="s2">&quot;f8&quot;</span><span class="p">,</span> <span class="s2">&quot;f4&quot;</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">({</span><span class="s2">&quot;names&quot;</span><span class="p">:</span> <span class="n">names</span><span class="p">,</span> <span class="s2">&quot;offsets&quot;</span><span class="p">:</span> <span class="n">offsets</span><span class="p">,</span> <span class="s2">&quot;formats&quot;</span><span class="p">:</span> <span class="n">formats</span><span class="p">},</span> <span class="n">align</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="s2">&quot;binary.dat&quot;</span><span class="p">,</span> <span class="n">dt</span><span class="p">))</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The offsets of the structure elements may be different depending on the
architecture of the machine on which the file was created. Using a raw
binary file format like this for general data storage is not recommended, as
it is not cross platform. We recommended either HDF5 or parquet, both of
which are supported by pandasâ€™ IO facilities.</p>
</div>
</section>
</section>
<section id="computation">
<h2>Computation<a class="headerlink" href="#computation" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="javascript:if(confirm('https://nbviewer.ipython.org/gist/metakermit/5720498  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://nbviewer.ipython.org/gist/metakermit/5720498'" tppabs="https://nbviewer.ipython.org/gist/metakermit/5720498">Numerical integration (sample-based) of a time series</a></p>
<section id="correlation">
<h3>Correlation<a class="headerlink" href="#correlation" title="Permalink to this headline">#</a></h3>
<p>Often itâ€™s useful to obtain the lower (or upper) triangular form of a correlation matrix calculated from <a class="reference internal" href="pandas.DataFrame.corr.html#pandas.DataFrame.corr" tppabs="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.corr.html#pandas.DataFrame.corr" title="pandas.DataFrame.corr"><code class="xref py py-func docutils literal notranslate"><span class="pre">DataFrame.corr()</span></code></a>. This can be achieved by passing a boolean mask to <code class="docutils literal notranslate"><span class="pre">where</span></code> as follows:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [215]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">5</span><span class="p">)))</span>

<span class="gp">In [216]: </span><span class="n">corr_mat</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>

<span class="gp">In [217]: </span><span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tril</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">corr_mat</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">),</span> <span class="n">k</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">In [218]: </span><span class="n">corr_mat</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
<span class="gh">Out[218]: </span><span class="go"></span>
<span class="go">          0         1         2        3   4</span>
<span class="go">0       NaN       NaN       NaN      NaN NaN</span>
<span class="go">1 -0.079861       NaN       NaN      NaN NaN</span>
<span class="go">2 -0.236573  0.183801       NaN      NaN NaN</span>
<span class="go">3 -0.013795 -0.051975  0.037235      NaN NaN</span>
<span class="go">4 -0.031974  0.118342 -0.073499 -0.02063 NaN</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">method</span></code> argument within <code class="docutils literal notranslate"><span class="pre">DataFrame.corr</span></code> can accept a callable in addition to the named correlation types. Here we compute the <a class="reference external" href="javascript:if(confirm('https://en.wikipedia.org/wiki/Distance_correlation  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://en.wikipedia.org/wiki/Distance_correlation'" tppabs="https://en.wikipedia.org/wiki/Distance_correlation">distance correlation</a> matrix for a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> object.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [219]: </span><span class="k">def</span> <span class="nf">distcorr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="gp">   .....: </span>    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">   .....: </span>    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
<span class="gp">   .....: </span>    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
<span class="gp">   .....: </span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="gp">   .....: </span>        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="gp">   .....: </span>            <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
<span class="gp">   .....: </span>            <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
<span class="gp">   .....: </span>    <span class="n">a</span> <span class="o">+=</span> <span class="n">a</span><span class="o">.</span><span class="n">T</span>
<span class="gp">   .....: </span>    <span class="n">b</span> <span class="o">+=</span> <span class="n">b</span><span class="o">.</span><span class="n">T</span>
<span class="gp">   .....: </span>    <span class="n">a_bar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span> <span class="o">*</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">   .....: </span>    <span class="n">b_bar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)]</span> <span class="o">*</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">   .....: </span>    <span class="n">A</span> <span class="o">=</span> <span class="n">a</span> <span class="o">-</span> <span class="n">a_bar</span> <span class="o">-</span> <span class="n">a_bar</span><span class="o">.</span><span class="n">T</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">fill_value</span><span class="o">=</span><span class="n">a_bar</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="gp">   .....: </span>    <span class="n">B</span> <span class="o">=</span> <span class="n">b</span> <span class="o">-</span> <span class="n">b_bar</span> <span class="o">-</span> <span class="n">b_bar</span><span class="o">.</span><span class="n">T</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">fill_value</span><span class="o">=</span><span class="n">b_bar</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="gp">   .....: </span>    <span class="n">cov_ab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nansum</span><span class="p">(</span><span class="n">A</span> <span class="o">*</span> <span class="n">B</span><span class="p">))</span> <span class="o">/</span> <span class="n">n</span>
<span class="gp">   .....: </span>    <span class="n">std_a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nansum</span><span class="p">(</span><span class="n">A</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">   .....: </span>    <span class="n">std_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nansum</span><span class="p">(</span><span class="n">B</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">   .....: </span>    <span class="k">return</span> <span class="n">cov_ab</span> <span class="o">/</span> <span class="n">std_a</span> <span class="o">/</span> <span class="n">std_b</span>
<span class="gp">   .....: </span>

<span class="gp">In [220]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span>

<span class="gp">In [221]: </span><span class="n">df</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">distcorr</span><span class="p">)</span>
<span class="gh">Out[221]: </span><span class="go"></span>
<span class="go">          0         1         2</span>
<span class="go">0  1.000000  0.197613  0.216328</span>
<span class="go">1  0.197613  1.000000  0.208749</span>
<span class="go">2  0.216328  0.208749  1.000000</span>
</pre></div>
</div>
</section>
</section>
<section id="timedeltas">
<h2>Timedeltas<a class="headerlink" href="#timedeltas" title="Permalink to this headline">#</a></h2>
<p>The <a class="reference internal" href="timedeltas.html#timedeltas-timedeltas" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/timedeltas.html#timedeltas-timedeltas"><span class="std std-ref">Timedeltas</span></a> docs.</p>
<p><a class="reference external" href="javascript:if(confirm('https://github.com/pandas-dev/pandas/pull/2899  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/pandas-dev/pandas/pull/2899'" tppabs="https://github.com/pandas-dev/pandas/pull/2899">Using timedeltas</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [222]: </span><span class="kn">import</span> <span class="nn">datetime</span>

<span class="gp">In [223]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s2">&quot;2012-1-1&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;D&quot;</span><span class="p">))</span>

<span class="gp">In [224]: </span><span class="n">s</span> <span class="o">-</span> <span class="n">s</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="gh">Out[224]: </span><span class="go"></span>
<span class="go">0   -2 days</span>
<span class="go">1   -1 days</span>
<span class="go">2    0 days</span>
<span class="go">dtype: timedelta64[ns]</span>

<span class="gp">In [225]: </span><span class="n">s</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">s</span>
<span class="gh">Out[225]: </span><span class="go"></span>
<span class="go">0   2 days</span>
<span class="go">1   1 days</span>
<span class="go">2   0 days</span>
<span class="go">dtype: timedelta64[ns]</span>

<span class="gp">In [226]: </span><span class="n">s</span> <span class="o">-</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2011</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gh">Out[226]: </span><span class="go"></span>
<span class="go">0   364 days 20:55:00</span>
<span class="go">1   365 days 20:55:00</span>
<span class="go">2   366 days 20:55:00</span>
<span class="go">dtype: timedelta64[ns]</span>

<span class="gp">In [227]: </span><span class="n">s</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gh">Out[227]: </span><span class="go"></span>
<span class="go">0   2012-01-01 00:05:00</span>
<span class="go">1   2012-01-02 00:05:00</span>
<span class="go">2   2012-01-03 00:05:00</span>
<span class="go">dtype: datetime64[ns]</span>

<span class="gp">In [228]: </span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2011</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-</span> <span class="n">s</span>
<span class="gh">Out[228]: </span><span class="go"></span>
<span class="go">0   -365 days +03:05:00</span>
<span class="go">1   -366 days +03:05:00</span>
<span class="go">2   -367 days +03:05:00</span>
<span class="go">dtype: timedelta64[ns]</span>

<span class="gp">In [229]: </span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="n">s</span>
<span class="gh">Out[229]: </span><span class="go"></span>
<span class="go">0   2012-01-01 00:05:00</span>
<span class="go">1   2012-01-02 00:05:00</span>
<span class="go">2   2012-01-03 00:05:00</span>
<span class="go">dtype: datetime64[ns]</span>
</pre></div>
</div>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/16385785/add-days-to-dates-in-dataframe  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/16385785/add-days-to-dates-in-dataframe'" tppabs="https://stackoverflow.com/questions/16385785/add-days-to-dates-in-dataframe">Adding and subtracting deltas and dates</a></p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [230]: </span><span class="n">deltas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>

<span class="gp">In [231]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="n">s</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="n">deltas</span><span class="p">})</span>

<span class="gp">In [232]: </span><span class="n">df</span>
<span class="gh">Out[232]: </span><span class="go"></span>
<span class="go">           A      B</span>
<span class="go">0 2012-01-01 0 days</span>
<span class="go">1 2012-01-02 1 days</span>
<span class="go">2 2012-01-03 2 days</span>

<span class="gp">In [233]: </span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;New Dates&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">]</span>

<span class="gp">In [234]: </span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Delta&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;New Dates&quot;</span><span class="p">]</span>

<span class="gp">In [235]: </span><span class="n">df</span>
<span class="gh">Out[235]: </span><span class="go"></span>
<span class="go">           A      B  New Dates   Delta</span>
<span class="go">0 2012-01-01 0 days 2012-01-01  0 days</span>
<span class="go">1 2012-01-02 1 days 2012-01-03 -1 days</span>
<span class="go">2 2012-01-03 2 days 2012-01-05 -2 days</span>

<span class="gp">In [236]: </span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
<span class="gh">Out[236]: </span><span class="go"></span>
<span class="go">A             datetime64[ns]</span>
<span class="go">B            timedelta64[ns]</span>
<span class="go">New Dates     datetime64[ns]</span>
<span class="go">Delta        timedelta64[ns]</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
<p><a class="reference external" href="javascript:if(confirm('https://stackoverflow.com/questions/15683588/iterating-through-a-pandas-dataframe  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/15683588/iterating-through-a-pandas-dataframe'" tppabs="https://stackoverflow.com/questions/15683588/iterating-through-a-pandas-dataframe">Another example</a></p>
<p>Values can be set to NaT using np.nan, similar to datetime</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [237]: </span><span class="n">y</span> <span class="o">=</span> <span class="n">s</span> <span class="o">-</span> <span class="n">s</span><span class="o">.</span><span class="n">shift</span><span class="p">()</span>

<span class="gp">In [238]: </span><span class="n">y</span>
<span class="gh">Out[238]: </span><span class="go"></span>
<span class="go">0      NaT</span>
<span class="go">1   1 days</span>
<span class="go">2   1 days</span>
<span class="go">dtype: timedelta64[ns]</span>

<span class="gp">In [239]: </span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="gp">In [240]: </span><span class="n">y</span>
<span class="gh">Out[240]: </span><span class="go"></span>
<span class="go">0      NaT</span>
<span class="go">1      NaT</span>
<span class="go">2   1 days</span>
<span class="go">dtype: timedelta64[ns]</span>
</pre></div>
</div>
</section>
<section id="creating-example-data">
<h2>Creating example data<a class="headerlink" href="#creating-example-data" title="Permalink to this headline">#</a></h2>
<p>To create a dataframe from every combination of some given values, like Râ€™s <code class="docutils literal notranslate"><span class="pre">expand.grid()</span></code>
function, we can create a dict where the keys are column names and the values are lists
of the data values:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [241]: </span><span class="k">def</span> <span class="nf">expand_grid</span><span class="p">(</span><span class="n">data_dict</span><span class="p">):</span>
<span class="gp">   .....: </span>    <span class="n">rows</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">data_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="gp">   .....: </span>    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">data_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="gp">   .....: </span>

<span class="gp">In [242]: </span><span class="n">df</span> <span class="o">=</span> <span class="n">expand_grid</span><span class="p">(</span>
<span class="gp">   .....: </span>    <span class="p">{</span><span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">60</span><span class="p">,</span> <span class="mi">70</span><span class="p">],</span> <span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">180</span><span class="p">],</span> <span class="s2">&quot;sex&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Male&quot;</span><span class="p">,</span> <span class="s2">&quot;Female&quot;</span><span class="p">]}</span>
<span class="gp">   .....: </span><span class="p">)</span>
<span class="gp">   .....: </span>

<span class="gp">In [243]: </span><span class="n">df</span>
<span class="gh">Out[243]: </span><span class="go"></span>
<span class="go">    height  weight     sex</span>
<span class="go">0       60     100    Male</span>
<span class="go">1       60     100  Female</span>
<span class="go">2       60     140    Male</span>
<span class="go">3       60     140  Female</span>
<span class="go">4       60     180    Male</span>
<span class="go">5       60     180  Female</span>
<span class="go">6       70     100    Male</span>
<span class="go">7       70     100  Female</span>
<span class="go">8       70     140    Male</span>
<span class="go">9       70     140  Female</span>
<span class="go">10      70     180    Male</span>
<span class="go">11      70     180  Female</span>
</pre></div>
</div>
</section>
</section>
</article>
<footer class="bd-footer-article">

<div class='prev-next-area'>
<a class='left-prev' id="prev-link" href="gotchas.html" tppabs="https://pandas.pydata.org/pandas-docs/stable/user_guide/gotchas.html" title="previous page">
<i class="fas fa-angle-left"></i>
<div class="prev-next-info">
<p class="prev-next-subtitle">previous</p>
<p class="prev-next-title">Frequently Asked Questions (FAQ)</p>
</div>
</a>
<a class='right-next' id="next-link" href="index-2.html" tppabs="https://pandas.pydata.org/pandas-docs/stable/reference/index.html" title="next page">
<div class="prev-next-info">
<p class="prev-next-subtitle">next</p>
<p class="prev-next-title">API reference</p>
</div>
<i class="fas fa-angle-right"></i>
</a>
</div>
</footer>
</div>
<div class="bd-sidebar-secondary bd-toc">
<div class="toc-item">
<div class="tocsection onthispage">
<i class="fas fa-list"></i> On this page
</div>
<nav id="bd-toc-nav" class="page-toc">
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#idioms">
Idioms
</a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#if-then">
if-thenâ€¦
</a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#splitting">
Splitting
</a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#building-criteria">
Building criteria
</a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#selection">
Selection
</a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#dataframes">
Dataframes
</a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#new-columns">
New columns
</a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#multiindexing">
Multiindexing
</a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#arithmetic">
Arithmetic
</a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#slicing">
Slicing
</a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#sorting">
Sorting
</a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#levels">
Levels
</a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#missing-data">
Missing data
</a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#replace">
Replace
</a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#grouping">
Grouping
</a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#expanding-data">
Expanding data
</a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id2">
Splitting
</a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#pivot">
Pivot
</a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#apply">
Apply
</a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#timeseries">
Timeseries
</a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#resampling">
Resampling
</a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#merge">
Merge
</a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#plotting">
Plotting
</a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#data-in-out">
Data in/out
</a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#csv">
CSV
</a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#reading-multiple-files-to-create-a-single-dataframe">
Reading multiple files to create a single DataFrame
</a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#parsing-date-components-in-multi-columns">
Parsing date components in multi-columns
</a>
</li>
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#skip-row-between-header-and-data">
Skip row between header and data
</a>
<ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry">
<a class="reference internal nav-link" href="#option-1-pass-rows-explicitly-to-skip-rows">
Option 1: pass rows explicitly to skip rows
</a>
</li>
<li class="toc-h5 nav-item toc-entry">
<a class="reference internal nav-link" href="#option-2-read-column-names-and-then-data">
Option 2: read column names and then data
</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#sql">
SQL
</a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#excel">
Excel
</a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#html">
HTML
</a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#hdfstore">
HDFStore
</a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#binary-files">
Binary files
</a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#computation">
Computation
</a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#correlation">
Correlation
</a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#timedeltas">
Timedeltas
</a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#creating-example-data">
Creating example data
</a>
</li>
</ul>
</nav>
</div>
<div class="toc-item">
</div>
<div class="toc-item">
<div class="tocsection sourcelink">
<a href="cookbook.rst.txt.htm" tppabs="https://pandas.pydata.org/pandas-docs/stable/_sources/user_guide/cookbook.rst.txt">
<i class="fas fa-file-alt"></i> Show Source
</a>
</div>
</div>
</div>
</div>
<footer class="bd-footer-content">
<div class="bd-footer-content__inner">
</div>
</footer>
</main>
</div>
</div>

<script src="pydata-sphinx-theme.js-digest=9b1a4fa89bdd0e95b23b" tppabs="https://pandas.pydata.org/pandas-docs/stable/_static/scripts/pydata-sphinx-theme.js?digest=9b1a4fa89bdd0e95b23b"></script>
<footer class="bd-footer"><div class="bd-footer__inner container">
<div class="footer-item">
<p class="copyright">
&copy 2022 pandas via <a href="javascript:if(confirm('https://numfocus.org/  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://numfocus.org/'" tppabs="https://numfocus.org/">NumFOCUS, Inc.</a> Hosted by <a href="javascript:if(confirm('https://www.ovhcloud.com/  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.ovhcloud.com/'" tppabs="https://www.ovhcloud.com/">OVHcloud</a>.
</p>
</div>
<div class="footer-item">
<p class="sphinx-version">
Created using <a href="javascript:if(confirm('http://sphinx-doc.org/  \n\n¸ÃÎÄ¼þÎÞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·þÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://sphinx-doc.org/'" tppabs="http://sphinx-doc.org/">Sphinx</a> 4.5.0.<br>
</p>
</div>
</div>
</footer>
</body>
</html>